# ExtraTreesClassifier_RandomOverSampler_2022-01-08_no3
## Constants
- CSV_PATH = ../out/csv/experiment
- OUTPUT_PATH = ../out/experiment_result/data_of_2022-01-07/AGC-0angle-under5m
- FEATURE_ATTRBS = ['low_power', 'high_power', 'hlbr', 'coe1[0]', 'coe1[1]', 'coe3[0]', 'coe3[1]', 'coe3[2]', 'coe3[3]', 'ratio_max_to_10ms_ave_peaks', 'ratio_max_to_9th_ave_peaks', 'ac_std', 'ac_auc', 'diff_std', 'diff_auc', 'srmr', 'gp_max_val_std', 'gp_max_val_range', 'gp_max_val_min', 'gp_max_val_max', 'gp_max_val_mean', 'gp_max_ix_std', 'gp_max_ix_range', 'gp_max_ix_min', 'gp_max_ix_max', 'gp_max_ix_mean', 'gp_auc_std', 'gp_auc_range', 'gp_auc_min', 'gp_auc_max', 'gp_auc_mean', 'tdoa_std', 'tdoa_range', 'tdoa_min', 'tdoa_max', 'tdoa_mean']
- LABEL_ATTRB = ['facing']
- FACING_DOV_ANGLES = [1]
- NCV = 8
- SCORING = ['accuracy', 'balanced_accuracy', 'f1']
- REFIT_SCORING = balanced_accuracy
- PARAM_GRID = [{'est__n_estimators': [50, 100, 150, 200, 300], 'est__min_samples_split': [2, 5, 10], 'est__min_samples_leaf': [1, 5, 10], 'est__max_features': ['sqrt', 'log2', None], 'est__bootstrap': [False], 'est__n_jobs': [-1], 'est__random_state': [42], 'est__max_samples': [0.01, 0.5, 0.09]}, {'est__n_estimators': [50, 100, 150, 200, 300], 'est__min_samples_split': [2, 5, 10], 'est__min_samples_leaf': [1, 5, 10], 'est__max_features': ['sqrt', 'log2', None], 'est__bootstrap': [True], 'est__oob_score': [True, False], 'est__n_jobs': [-1], 'est__random_state': [42], 'est__max_samples': [0.01, 0.5, 0.09]}]
- TRAIN_SET_SESSION = ['trial1', 'trial2']
- TEST_SET_SESSION = ['trial3', 'trial4', 'trial5']
- DISTANCE = [1, 3, 5]
- AGC_STATUS = ['AGC']

## Loaded CSV
- 2021-12-27_raspi_48000Hz_w1_N2^12_overlap80_with2022-01-07.csv

## Estimator
### Type
- resampler = RandomOverSampler
- estimator = ExtraTreesClassifier

### Arguments for hyperparameter search
- resampler = RandomOverSampler
- estimator = ExtraTreesClassifier
- param_grid = 
	- {'est__n_estimators': [50, 100, 150, 200, 300], 'est__min_samples_split': [2, 5, 10], 'est__min_samples_leaf': [1, 5, 10], 'est__max_features': ['sqrt', 'log2', None], 'est__bootstrap': [False], 'est__n_jobs': [-1], 'est__random_state': [42], 'est__max_samples': [0.01, 0.5, 0.09]}
	- {'est__n_estimators': [50, 100, 150, 200, 300], 'est__min_samples_split': [2, 5, 10], 'est__min_samples_leaf': [1, 5, 10], 'est__max_features': ['sqrt', 'log2', None], 'est__bootstrap': [True], 'est__oob_score': [True, False], 'est__n_jobs': [-1], 'est__random_state': [42], 'est__max_samples': [0.01, 0.5, 0.09]}

- scoring = ['accuracy', 'balanced_accuracy', 'f1']
- refit = balanced_accuracy
- cv = 8

### Parameters of the best estimator
#### The best hyper-parameters
- best_resampler
	- sampling_strategy = auto
	- random_state = 42
	- shrinkage = None
	- n_features_in_ = 36
	- sampling_strategy_ = OrderedDict([(1, 90)])
	- shrinkage_ = None
	- sample_indices_ = [  0   1   2   3   4   5   6   7   8   9  10  11  12  13  14  15  16  17
  18  19  20  21  22  23  24  25  26  27  28  29  30  31  32  33  34  35
  36  37  38  39  40  41  42  43  44  45  46  47  48  49  50  51  52  53
  54  55  56  57  58  59  60  61  62  63  64  65  66  67  68  69  70  71
  72  73  74  75  76  77  78  79  80  81  82  83  84  85  86  87  88  89
  90  91  92  93  94  95  96  97  98  99 100 101 102 103 104 105 106 107
 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125
 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143
 144 145 146 147 148 149  32  97 148  74  52  33 148 106  32 129  96 116
  52  52 117 106  11  33 117  10 107 106   1 117  53 149  21   1 139 106
   0  53 129 107 148  53 128  84 138 138  43 139 139  75  74 149 149  74
 149  96  53 116  97 128  10  20  96  32 106  42  32  85  11 128 139  65
  85 129  42 129 106   1  97 139  74 139  32  53 148  33  74  10  65  84
  11  85  33  11   1 149]

- best_estimator
	- base_estimator = ExtraTreeClassifier()
	- n_estimators = 50
	- estimator_params = ('criterion', 'max_depth', 'min_samples_split', 'min_samples_leaf', 'min_weight_fraction_leaf', 'max_features', 'max_leaf_nodes', 'min_impurity_decrease', 'min_impurity_split', 'random_state', 'ccp_alpha')
	- bootstrap = True
	- oob_score = True
	- n_jobs = -1
	- random_state = 42
	- verbose = 0
	- warm_start = False
	- class_weight = None
	- max_samples = 0.5
	- criterion = gini
	- max_depth = None
	- min_samples_split = 2
	- min_samples_leaf = 5
	- min_weight_fraction_leaf = 0.0
	- max_features = log2
	- max_leaf_nodes = None
	- min_impurity_decrease = 0.0
	- min_impurity_split = None
	- ccp_alpha = 0.0
	- n_features_in_ = 36
	- n_features_ = 36
	- n_outputs_ = 1
	- classes_ = [0 1]
	- n_classes_ = 2
	- base_estimator_ = ExtraTreeClassifier()
	- oob_decision_function_ = [[0.30696619 0.69303381]
 [0.27970418 0.72029582]
 [0.38302814 0.61697186]
 [0.39938622 0.60061378]
 [0.37011504 0.62988496]
 [0.60769192 0.39230808]
 [0.8967785  0.1032215 ]
 [0.90400923 0.09599077]
 [0.96468719 0.03531281]
 [0.9487013  0.0512987 ]
 [0.12979477 0.87020523]
 [0.41238877 0.58761123]
 [0.44000335 0.55999665]
 [0.36494889 0.63505111]
 [0.74554326 0.25445674]
 [0.53642524 0.46357476]
 [0.97476852 0.02523148]
 [0.97837302 0.02162698]
 [0.95759672 0.04240328]
 [0.93418679 0.06581321]
 [0.41133749 0.58866251]
 [0.36906787 0.63093213]
 [0.80108802 0.19891198]
 [0.4875386  0.5124614 ]
 [0.86136304 0.13863696]
 [0.90492063 0.09507937]
 [0.97845442 0.02154558]
 [0.98862018 0.01137982]
 [0.9965035  0.0034965 ]
 [0.98335629 0.01664371]
 [0.30590709 0.69409291]
 [0.39616386 0.60383614]
 [0.24964727 0.75035273]
 [0.35795524 0.64204476]
 [0.41271364 0.58728636]
 [0.46571025 0.53428975]
 [0.7072976  0.2927024 ]
 [0.71073404 0.28926596]
 [0.95667907 0.04332093]
 [0.97051282 0.02948718]
 [0.22660237 0.77339763]
 [0.62131625 0.37868375]
 [0.27717823 0.72282177]
 [0.22209441 0.77790559]
 [0.45957103 0.54042897]
 [0.2431097  0.7568903 ]
 [0.79645894 0.20354106]
 [0.72348285 0.27651715]
 [0.96583756 0.03416244]
 [0.97739621 0.02260379]
 [0.56581477 0.43418523]
 [0.48521881 0.51478119]
 [0.50534276 0.49465724]
 [0.29611014 0.70388986]
 [0.30630383 0.69369617]
 [0.42397648 0.57602352]
 [0.84033864 0.15966136]
 [0.82365857 0.17634143]
 [0.92507872 0.07492128]
 [0.94660088 0.05339912]
 [0.77041245 0.22958755]
 [0.80491473 0.19508527]
 [0.47146604 0.52853396]
 [0.48909801 0.51090199]
 [0.55845489 0.44154511]
 [0.44914799 0.55085201]
 [0.3911674  0.6088326 ]
 [0.42062347 0.57937653]
 [0.65540621 0.34459379]
 [0.60424837 0.39575163]
 [0.63921499 0.36078501]
 [0.86822042 0.13177958]
 [0.59511518 0.40488482]
 [0.42307708 0.57692292]
 [0.17939912 0.82060088]
 [0.21576823 0.78423177]
 [0.48972047 0.51027953]
 [0.40065123 0.59934877]
 [0.59055451 0.40944549]
 [0.61100859 0.38899141]
 [0.9550864  0.0449136 ]
 [0.95798382 0.04201618]
 [0.82338758 0.17661242]
 [0.67235919 0.32764081]
 [0.31673916 0.68326084]
 [0.18830695 0.81169305]
 [0.4759614  0.5240386 ]
 [0.31531656 0.68468344]
 [0.84391235 0.15608765]
 [0.95613018 0.04386982]
 [0.94062977 0.05937023]
 [0.92115461 0.07884539]
 [0.70017878 0.29982122]
 [0.78498226 0.21501774]
 [0.41992871 0.58007129]
 [0.46366342 0.53633658]
 [0.18266732 0.81733268]
 [0.26238471 0.73761529]
 [0.45465252 0.54534748]
 [0.46154013 0.53845987]
 [0.919354   0.080646  ]
 [0.98237179 0.01762821]
 [0.82654812 0.17345188]
 [0.83683855 0.16316145]
 [0.36833336 0.63166664]
 [0.28939052 0.71060948]
 [0.21147453 0.78852547]
 [0.25515573 0.74484427]
 [0.38674138 0.61325862]
 [0.35181984 0.64818016]
 [0.9841954  0.0158046 ]
 [0.95961538 0.04038462]
 [0.94699093 0.05300907]
 [0.92837377 0.07162623]
 [0.6485379  0.3514621 ]
 [0.59406406 0.40593594]
 [0.24449406 0.75550594]
 [0.16878618 0.83121382]
 [0.38692556 0.61307444]
 [0.71869795 0.28130205]
 [1.         0.        ]
 [0.97118665 0.02881335]
 [0.92074242 0.07925758]
 [0.84921223 0.15078777]
 [0.74529175 0.25470825]
 [0.73401115 0.26598885]
 [0.32587472 0.67412528]
 [0.44230928 0.55769072]
 [0.36696549 0.63303451]
 [0.28578887 0.71421113]
 [0.95046296 0.04953704]
 [0.97340931 0.02659069]
 [0.98302469 0.01697531]
 [0.95422648 0.04577352]
 [0.81484105 0.18515895]
 [0.68066652 0.31933348]
 [0.39195283 0.60804717]
 [0.43495056 0.56504944]
 [0.17466829 0.82533171]
 [0.15749139 0.84250861]
 [1.         0.        ]
 [1.         0.        ]
 [0.98472222 0.01527778]
 [0.98327324 0.01672676]
 [0.95334625 0.04665375]
 [0.91566043 0.08433957]
 [0.49556597 0.50443403]
 [0.59417491 0.40582509]
 [0.2094358  0.7905642 ]
 [0.33088295 0.66911705]
 [0.25949914 0.74050086]
 [0.23524207 0.76475793]
 [0.20466517 0.79533483]
 [0.15780687 0.84219313]
 [0.53661877 0.46338123]
 [0.41904444 0.58095556]
 [0.21995975 0.78004025]
 [0.23265419 0.76734581]
 [0.26364028 0.73635972]
 [0.25303477 0.74696523]
 [0.19024641 0.80975359]
 [0.25911628 0.74088372]
 [0.57534994 0.42465006]
 [0.50323618 0.49676382]
 [0.23607217 0.76392783]
 [0.20975942 0.79024058]
 [0.42010355 0.57989645]
 [0.35703078 0.64296922]
 [0.22003565 0.77996435]
 [0.12770204 0.87229796]
 [0.26110851 0.73889149]
 [0.23426251 0.76573749]
 [0.3028362  0.6971638 ]
 [0.2241818  0.7758182 ]
 [0.37505369 0.62494631]
 [0.33575804 0.66424196]
 [0.29679784 0.70320216]
 [0.28145218 0.71854782]
 [0.13702661 0.86297339]
 [0.23119884 0.76880116]
 [0.27728771 0.72271229]
 [0.321286   0.678714  ]
 [0.26127654 0.73872346]
 [0.24712859 0.75287141]
 [0.25851408 0.74148592]
 [0.32256717 0.67743283]
 [0.3533033  0.6466967 ]
 [0.28739787 0.71260213]
 [0.22008456 0.77991544]
 [0.16994561 0.83005439]
 [0.25490764 0.74509236]
 [0.21134978 0.78865022]
 [0.13746292 0.86253708]
 [0.2650677  0.7349323 ]
 [0.19297119 0.80702881]
 [0.36567252 0.63432748]
 [0.33526471 0.66473529]
 [0.15632265 0.84367735]
 [0.31444443 0.68555557]
 [0.22968569 0.77031431]
 [0.31636166 0.68363834]
 [0.17866763 0.82133237]
 [0.27277019 0.72722981]
 [0.35008426 0.64991574]
 [0.12506624 0.87493376]
 [0.49527739 0.50472261]
 [0.16516501 0.83483499]
 [0.25019015 0.74980985]
 [0.23322566 0.76677434]
 [0.28724911 0.71275089]
 [0.22383187 0.77616813]
 [0.18073279 0.81926721]
 [0.31587034 0.68412966]
 [0.39634667 0.60365333]
 [0.18338376 0.81661624]
 [0.49155077 0.50844923]
 [0.22362588 0.77637412]
 [0.28306744 0.71693256]
 [0.27082989 0.72917011]
 [0.28197283 0.71802717]
 [0.20572183 0.79427817]
 [0.23964447 0.76035553]
 [0.28241391 0.71758609]
 [0.12300391 0.87699609]
 [0.15335185 0.84664815]
 [0.16375042 0.83624958]
 [0.22612643 0.77387357]
 [0.32652719 0.67347281]
 [0.2598168  0.7401832 ]
 [0.42474194 0.57525806]
 [0.15768495 0.84231505]
 [0.12381391 0.87618609]
 [0.48806595 0.51193405]
 [0.33896273 0.66103727]
 [0.35624659 0.64375341]
 [0.21735177 0.78264823]
 [0.36341385 0.63658615]
 [0.3559602  0.6440398 ]
 [0.24499398 0.75500602]
 [0.30523205 0.69476795]]
	- oob_score_ = 0.8166666666666667

#### Importance of features
- gp_auc_min = 0.10459074871185492
- gp_auc_max = 0.09788496941225654
- high_power = 0.0777360938853139
- gp_auc_mean = 0.07655768061986332
- gp_max_val_min = 0.06395424419365942
- gp_max_val_max = 0.060136224936588475
- gp_max_val_mean = 0.05555074765996854
- hlbr = 0.05066880434308073
- diff_std = 0.047716372470972754
- low_power = 0.04657159995296872
- diff_auc = 0.03669514168331188
- coe1[0] = 0.028712485572571275
- srmr = 0.024808497150398547
- gp_auc_range = 0.02473868680496863
- ac_auc = 0.021061334439389456
- coe3[3] = 0.016119988483342073
- coe1[1] = 0.015874211610860816
- ratio_max_to_10ms_ave_peaks = 0.014272454440117115
- ac_std = 0.013300217325342605
- gp_max_val_std = 0.013017484726921815
- tdoa_mean = 0.011168692526956767
- gp_max_ix_std = 0.01105721953472138
- tdoa_min = 0.010059754393145806
- gp_max_ix_range = 0.009807630779090963
- gp_auc_std = 0.009591606837571983
- gp_max_ix_mean = 0.008832251197060974
- coe3[2] = 0.007624002465771604
- tdoa_max = 0.0072975505375205444
- tdoa_range = 0.0070242349046541995
- tdoa_std = 0.0067525538672342355
- gp_max_val_range = 0.006727756766499779
- ratio_max_to_9th_ave_peaks = 0.006224359791954868
- gp_max_ix_min = 0.00430418577961249
- gp_max_ix_max = 0.0035602121944530636
- coe3[0] = 0.0
- coe3[1] = 0.0

## Evaluation
cv = 8
### accuracy
- Scores = [ 0.6896551724137931, 0.8214285714285714, 0.7857142857142857, 0.75, 0.8214285714285714, 0.6785714285714286, 0.75, 0.8214285714285714 ]
- Mean = 0.7647783251231527
- Standard deviation = 0.054288558345925796

### balanced_accuracy
- Scores = [ 0.7427536231884058, 0.8863636363636364, 0.6818181818181819, 0.7803030303030303, 0.8863636363636364, 0.8043478260869565, 0.7695652173913043, 0.7347826086956522 ]
- Mean = 0.7857872200263504
- Standard deviation = 0.06720479762449064

### f1
- Scores = [ 0.5263157894736842, 0.7058823529411764, 0.5, 0.5882352941176471, 0.7058823529411764, 0.5263157894736842, 0.5333333333333333, 0.5454545454545454 ]
- Mean = 0.5789274322169059
- Standard deviation = 0.07688181315111263

### Confusion Matrix
|  | Predicted Negative | Predicted Positive |
| --- | --- | --- |
| Actual Negative | 128 | 52 |
| Actual Positive | 6 | 39 |

      