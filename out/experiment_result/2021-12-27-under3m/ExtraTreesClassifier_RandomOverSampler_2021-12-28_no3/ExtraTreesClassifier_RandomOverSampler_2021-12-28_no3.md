# ExtraTreesClassifier_RandomOverSampler_2021-12-28_no3
## Constants
- CSV_PATH = ../out/csv/experiment
- OUTPUT_PATH = ../out/experiment_result/2021-12-27-under3m
- FEATURE_ATTRBS = ['low_power', 'high_power', 'hlbr', 'coe1[0]', 'coe1[1]', 'coe3[0]', 'coe3[1]', 'coe3[2]', 'coe3[3]', 'ratio_max_to_10ms_ave_peaks', 'ratio_max_to_9th_ave_peaks', 'ac_std', 'ac_auc', 'diff_std', 'diff_auc', 'srmr', 'gp_max_val_std', 'gp_max_val_range', 'gp_max_val_min', 'gp_max_val_max', 'gp_max_val_mean', 'gp_max_ix_std', 'gp_max_ix_range', 'gp_max_ix_min', 'gp_max_ix_max', 'gp_max_ix_mean', 'gp_auc_std', 'gp_auc_range', 'gp_auc_min', 'gp_auc_max', 'gp_auc_mean', 'tdoa_std', 'tdoa_range', 'tdoa_min', 'tdoa_max', 'tdoa_mean']
- LABEL_ATTRB = ['facing']
- FACING_DOV_ANGLES = [1]
- NCV = 8
- SCORING = ['accuracy', 'balanced_accuracy', 'f1']
- REFIT_SCORING = balanced_accuracy
- PARAM_GRID = [{'est__n_estimators': [50, 100, 150, 200, 300], 'est__min_samples_split': [2, 5, 10], 'est__min_samples_leaf': [1, 5, 10], 'est__max_features': ['sqrt', 'log2', None], 'est__bootstrap': [False], 'est__n_jobs': [-1], 'est__random_state': [42], 'est__max_samples': [0.01, 0.5, 0.09]}, {'est__n_estimators': [50, 100, 150, 200, 300], 'est__min_samples_split': [2, 5, 10], 'est__min_samples_leaf': [1, 5, 10], 'est__max_features': ['sqrt', 'log2', None], 'est__bootstrap': [True], 'est__oob_score': [True, False], 'est__n_jobs': [-1], 'est__random_state': [42], 'est__max_samples': [0.01, 0.5, 0.09]}]
- TRAIN_SET_SESSION = ['trial1', 'trial2']
- TEST_SET_SESSION = ['trial3', 'trial4', 'trial5']

## Loaded CSV
- 2021-12-27_raspi_48000Hz_w1_N2^12_overlap80_withfacing.csv

## Estimator
### Type
- resampler = RandomOverSampler
- estimator = ExtraTreesClassifier

### Arguments for hyperparameter search
- resampler = RandomOverSampler
- estimator = ExtraTreesClassifier
- param_grid = 
	- {'est__n_estimators': [50, 100, 150, 200, 300], 'est__min_samples_split': [2, 5, 10], 'est__min_samples_leaf': [1, 5, 10], 'est__max_features': ['sqrt', 'log2', None], 'est__bootstrap': [False], 'est__n_jobs': [-1], 'est__random_state': [42], 'est__max_samples': [0.01, 0.5, 0.09]}
	- {'est__n_estimators': [50, 100, 150, 200, 300], 'est__min_samples_split': [2, 5, 10], 'est__min_samples_leaf': [1, 5, 10], 'est__max_features': ['sqrt', 'log2', None], 'est__bootstrap': [True], 'est__oob_score': [True, False], 'est__n_jobs': [-1], 'est__random_state': [42], 'est__max_samples': [0.01, 0.5, 0.09]}

- scoring = ['accuracy', 'balanced_accuracy', 'f1']
- refit = balanced_accuracy
- cv = 8

### Parameters of the best estimator
#### The best hyper-parameters
- best_resampler
	- sampling_strategy = auto
	- random_state = 42
	- shrinkage = None
	- n_features_in_ = 36
	- sampling_strategy_ = OrderedDict([(1, 58)])
	- shrinkage_ = None
	- sample_indices_ = [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23
 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47
 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71
 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95
 96 97 32 97 76 54 33 32 96 54 54 11 33 10  1 55 23  1  0 55 55 88 45 77
 76 76 96 55 97 10 22 96 32 44 32 89 11 67 89 44  1 97 76 32 55 33 76 10
 67 88 11 89 33 11  1 23 45 11 89 55]

- best_estimator
	- base_estimator = ExtraTreeClassifier()
	- n_estimators = 50
	- estimator_params = ('criterion', 'max_depth', 'min_samples_split', 'min_samples_leaf', 'min_weight_fraction_leaf', 'max_features', 'max_leaf_nodes', 'min_impurity_decrease', 'min_impurity_split', 'random_state', 'ccp_alpha')
	- bootstrap = True
	- oob_score = True
	- n_jobs = -1
	- random_state = 42
	- verbose = 0
	- warm_start = False
	- class_weight = None
	- max_samples = 0.5
	- criterion = gini
	- max_depth = None
	- min_samples_split = 10
	- min_samples_leaf = 1
	- min_weight_fraction_leaf = 0.0
	- max_features = log2
	- max_leaf_nodes = None
	- min_impurity_decrease = 0.0
	- min_impurity_split = None
	- ccp_alpha = 0.0
	- n_features_in_ = 36
	- n_features_ = 36
	- n_outputs_ = 1
	- classes_ = [0 1]
	- n_classes_ = 2
	- base_estimator_ = ExtraTreeClassifier()
	- oob_decision_function_ = [[0.34569895 0.65430105]
 [0.28145161 0.71854839]
 [0.41605709 0.58394291]
 [0.54691543 0.45308457]
 [0.38048711 0.61951289]
 [0.62403134 0.37596866]
 [0.99090909 0.00909091]
 [0.97419355 0.02580645]
 [1.         0.        ]
 [1.         0.        ]
 [0.17848458 0.82151542]
 [0.26372701 0.73627299]
 [0.59767356 0.40232644]
 [0.35506243 0.64493757]
 [0.9672619  0.0327381 ]
 [0.95645161 0.04354839]
 [1.         0.        ]
 [0.97142857 0.02857143]
 [0.85138889 0.14861111]
 [0.875      0.125     ]
 [0.31806885 0.68193115]
 [0.35080079 0.64919921]
 [0.27487302 0.72512698]
 [0.46396085 0.53603915]
 [0.49327922 0.50672078]
 [0.52741436 0.47258564]
 [0.77740741 0.22259259]
 [0.91515152 0.08484848]
 [1.         0.        ]
 [0.99393939 0.00606061]
 [0.90555556 0.09444444]
 [0.87718254 0.12281746]
 [0.1357002  0.8642998 ]
 [0.07619646 0.92380354]
 [0.45133251 0.54866749]
 [0.16610491 0.83389509]
 [0.96919192 0.03080808]
 [0.98010753 0.01989247]
 [1.         0.        ]
 [0.99666667 0.00333333]
 [0.92905983 0.07094017]
 [0.94819625 0.05180375]
 [0.52139314 0.47860686]
 [0.5547794  0.4452206 ]
 [0.47566825 0.52433175]
 [0.43438708 0.56561292]
 [0.49041147 0.50958853]
 [0.53626823 0.46373177]
 [0.85938697 0.14061303]
 [0.80386243 0.19613757]
 [0.99032258 0.00967742]
 [0.98333333 0.01666667]
 [0.88325062 0.11674938]
 [0.51678682 0.48321318]
 [0.08730809 0.91269191]
 [0.09515501 0.90484499]
 [0.48289919 0.51710081]
 [0.47861572 0.52138428]
 [0.946      0.054     ]
 [0.94821429 0.05178571]
 [0.99285714 0.00714286]
 [0.96222222 0.03777778]
 [0.76256614 0.23743386]
 [0.88506944 0.11493056]
 [0.50855523 0.49144477]
 [0.38954988 0.61045012]
 [0.19421551 0.80578449]
 [0.17129422 0.82870578]
 [0.56126227 0.43873773]
 [0.45733576 0.54266424]
 [0.97010582 0.02989418]
 [1.         0.        ]
 [0.96571429 0.03428571]
 [0.95107527 0.04892473]
 [0.4659263  0.5340737 ]
 [0.27671916 0.72328084]
 [0.11792464 0.88207536]
 [0.14026807 0.85973193]
 [0.57581159 0.42418841]
 [0.25736043 0.74263957]
 [1.         0.        ]
 [0.97948718 0.02051282]
 [1.         0.        ]
 [0.87988506 0.12011494]
 [0.9162518  0.0837482 ]
 [0.90422078 0.09577922]
 [0.49275733 0.50724267]
 [0.60749863 0.39250137]
 [0.48826788 0.51173212]
 [0.25407198 0.74592802]
 [0.98567493 0.01432507]
 [0.99393939 0.00606061]
 [0.98186275 0.01813725]
 [0.93056426 0.06943574]
 [0.79539399 0.20460601]
 [0.84972944 0.15027056]
 [0.31509506 0.68490494]
 [0.12469752 0.87530248]
 [0.1560054  0.8439946 ]
 [0.10967773 0.89032227]
 [0.11399177 0.88600823]
 [0.07568851 0.92431149]
 [0.08636364 0.91363636]
 [0.10774544 0.89225456]
 [0.27929005 0.72070995]
 [0.07633601 0.92366399]
 [0.07853222 0.92146778]
 [0.29040116 0.70959884]
 [0.05488178 0.94511822]
 [0.23821332 0.76178668]
 [0.23379577 0.76620423]
 [0.10364543 0.89635457]
 [0.4013654  0.5986346 ]
 [0.26548678 0.73451322]
 [0.30620479 0.69379521]
 [0.08236689 0.91763311]
 [0.0847952  0.9152048 ]
 [0.5142061  0.4857939 ]
 [0.41452197 0.58547803]
 [0.13539348 0.86460652]
 [0.14234679 0.85765321]
 [0.12471641 0.87528359]
 [0.36983694 0.63016306]
 [0.08199023 0.91800977]
 [0.11313131 0.88686869]
 [0.20410633 0.79589367]
 [0.22403792 0.77596208]
 [0.32974066 0.67025934]
 [0.15105083 0.84894917]
 [0.54672344 0.45327656]
 [0.19535368 0.80464632]
 [0.20294397 0.79705603]
 [0.26870414 0.73129586]
 [0.22322991 0.77677009]
 [0.24610749 0.75389251]
 [0.55069787 0.44930213]
 [0.27506804 0.72493196]
 [0.11140507 0.88859493]
 [0.12912045 0.87087955]
 [0.14681152 0.85318848]
 [0.09248682 0.90751318]
 [0.07838559 0.92161441]
 [0.1307708  0.8692292 ]
 [0.20850408 0.79149592]
 [0.17537812 0.82462188]
 [0.461339   0.538661  ]
 [0.22845118 0.77154882]
 [0.21200972 0.78799028]
 [0.08017765 0.91982235]
 [0.27745303 0.72254697]
 [0.30973044 0.69026956]
 [0.43893182 0.56106818]
 [0.45765652 0.54234348]
 [0.22899724 0.77100276]
 [0.24658437 0.75341563]
 [0.08874891 0.91125109]]
	- oob_score_ = 0.8717948717948718

#### Importance of features
- gp_auc_min = 0.1076149144856906
- gp_max_val_max = 0.09664777587649453
- gp_auc_max = 0.07694612344139658
- gp_max_val_mean = 0.0601654254472457
- gp_auc_mean = 0.05482419505615701
- gp_max_val_min = 0.052280419843514746
- diff_auc = 0.04789716709665587
- coe1[1] = 0.04528432702750346
- diff_std = 0.03457124151675319
- gp_auc_range = 0.032744254744214045
- high_power = 0.03256004381443147
- low_power = 0.03215019843393658
- coe1[0] = 0.030723966090294083
- ac_std = 0.026850665565421976
- srmr = 0.023272355121148287
- ac_auc = 0.021294818591765234
- coe3[2] = 0.01925955438108119
- gp_max_val_range = 0.018203496927219155
- hlbr = 0.017991186751853728
- coe3[3] = 0.01715945186835707
- tdoa_mean = 0.01652888123717353
- tdoa_std = 0.01646349972650861
- gp_max_ix_min = 0.015049881699667096
- gp_max_ix_range = 0.012738441971855839
- ratio_max_to_10ms_ave_peaks = 0.012670964119492187
- gp_auc_std = 0.011260272158360656
- gp_max_ix_mean = 0.010885004197189843
- tdoa_min = 0.010421967541596043
- ratio_max_to_9th_ave_peaks = 0.010176015321328806
- gp_max_ix_std = 0.009988022042783998
- gp_max_val_std = 0.009374325344363488
- gp_max_ix_max = 0.0076736188023168615
- tdoa_max = 0.004816968479054498
- tdoa_range = 0.003510555277174032
- coe3[0] = 0.0
- coe3[1] = 0.0

## Evaluation
cv = 8
### accuracy
- Scores = [ 0.47368421052631576, 0.6842105263157895, 0.9473684210526315, 0.7368421052631579, 0.9473684210526315, 0.7222222222222222, 0.8333333333333334, 0.8333333333333334 ]
- Mean = 0.7722953216374269
- Standard deviation = 0.14553531818061566

### balanced_accuracy
- Scores = [ 0.48333333333333334, 0.7083333333333333, 0.9666666666666667, 0.65, 0.9666666666666667, 0.7321428571428572, 0.6333333333333333, 0.5 ]
- Mean = 0.7050595238095239
- Standard deviation = 0.17212238689789475

### f1
- Scores = [ 0.28571428571428575, 0.5, 0.888888888888889, 0.4444444444444445, 0.888888888888889, 0.5454545454545454, 0.4, 0.0 ]
- Mean = 0.4941738816738817
- Standard deviation = 0.2768728249049946

### Confusion Matrix
|  | Predicted Negative | Predicted Positive |
| --- | --- | --- |
| Actual Negative | 96 | 23 |
| Actual Positive | 11 | 19 |

      