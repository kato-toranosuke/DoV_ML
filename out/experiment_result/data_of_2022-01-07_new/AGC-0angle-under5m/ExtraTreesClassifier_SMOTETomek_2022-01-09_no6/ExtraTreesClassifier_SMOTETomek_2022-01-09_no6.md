# ExtraTreesClassifier_SMOTETomek_2022-01-09_no6
## Constants
- CSV_PATH = ../out/csv/experiment
- OUTPUT_PATH = ../out/experiment_result/data_of_2022-01-07_new/AGC-0angle-under5m
- FEATURE_ATTRBS = ['low_power', 'high_power', 'hlbr', 'coe1[0]', 'coe1[1]', 'coe3[0]', 'coe3[1]', 'coe3[2]', 'coe3[3]', 'ratio_max_to_10ms_ave_peaks', 'ratio_max_to_9th_ave_peaks', 'ac_std', 'ac_auc', 'diff_std', 'diff_auc', 'srmr', 'gp_max_val_std', 'gp_max_val_range', 'gp_max_val_min', 'gp_max_val_max', 'gp_max_val_mean', 'gp_max_ix_std', 'gp_max_ix_range', 'gp_max_ix_min', 'gp_max_ix_max', 'gp_max_ix_mean', 'gp_auc_std', 'gp_auc_range', 'gp_auc_min', 'gp_auc_max', 'gp_auc_mean', 'tdoa_std', 'tdoa_range', 'tdoa_min', 'tdoa_max', 'tdoa_mean']
- LABEL_ATTRB = ['facing']
- FACING_DOV_ANGLES = [1]
- NCV = 8
- SCORING = ['accuracy', 'balanced_accuracy', 'f1']
- REFIT_SCORING = balanced_accuracy
- PARAM_GRID = [{'est__n_estimators': [50, 100, 150, 200, 300], 'est__min_samples_split': [2, 5, 10], 'est__min_samples_leaf': [1, 5, 10], 'est__max_features': ['sqrt', 'log2', None], 'est__bootstrap': [False], 'est__n_jobs': [-1], 'est__random_state': [42], 'est__max_samples': [0.01, 0.5, 0.09]}, {'est__n_estimators': [50, 100, 150, 200, 300], 'est__min_samples_split': [2, 5, 10], 'est__min_samples_leaf': [1, 5, 10], 'est__max_features': ['sqrt', 'log2', None], 'est__bootstrap': [True], 'est__oob_score': [True, False], 'est__n_jobs': [-1], 'est__random_state': [42], 'est__max_samples': [0.01, 0.5, 0.09]}]
- TRAIN_SET_SESSION = ['trial1', 'trial2']
- TEST_SET_SESSION = ['trial3', 'trial4', 'trial5']
- DISTANCE = [1, 3, 5]
- AGC_STATUS = ['AGC']

## Loaded CSV
- 2021-12-27_raspi_48000Hz_w1_N2^12_overlap80_with2022-01-07.csv

## Estimator
### Type
- resampler = SMOTETomek
- estimator = ExtraTreesClassifier

### Arguments for hyperparameter search
- resampler = SMOTETomek
- estimator = ExtraTreesClassifier
- param_grid = 
	- {'est__n_estimators': [50, 100, 150, 200, 300], 'est__min_samples_split': [2, 5, 10], 'est__min_samples_leaf': [1, 5, 10], 'est__max_features': ['sqrt', 'log2', None], 'est__bootstrap': [False], 'est__n_jobs': [-1], 'est__random_state': [42], 'est__max_samples': [0.01, 0.5, 0.09]}
	- {'est__n_estimators': [50, 100, 150, 200, 300], 'est__min_samples_split': [2, 5, 10], 'est__min_samples_leaf': [1, 5, 10], 'est__max_features': ['sqrt', 'log2', None], 'est__bootstrap': [True], 'est__oob_score': [True, False], 'est__n_jobs': [-1], 'est__random_state': [42], 'est__max_samples': [0.01, 0.5, 0.09]}

- scoring = ['accuracy', 'balanced_accuracy', 'f1']
- refit = balanced_accuracy
- cv = 8

### Parameters of the best estimator
#### The best hyper-parameters
- best_resampler
	- sampling_strategy = auto
	- random_state = 42
	- smote = None
	- tomek = None
	- n_jobs = -1
	- n_features_in_ = 36
	- sampling_strategy_ = auto
	- smote_ = SMOTE(n_jobs=-1, random_state=42)
	- tomek_ = TomekLinks(n_jobs=-1, sampling_strategy='all')

- best_estimator
	- base_estimator = ExtraTreeClassifier()
	- n_estimators = 50
	- estimator_params = ('criterion', 'max_depth', 'min_samples_split', 'min_samples_leaf', 'min_weight_fraction_leaf', 'max_features', 'max_leaf_nodes', 'min_impurity_decrease', 'random_state', 'ccp_alpha')
	- bootstrap = True
	- oob_score = True
	- n_jobs = -1
	- random_state = 42
	- verbose = 0
	- warm_start = False
	- class_weight = None
	- max_samples = 0.09
	- criterion = gini
	- max_depth = None
	- min_samples_split = 2
	- min_samples_leaf = 1
	- min_weight_fraction_leaf = 0.0
	- max_features = log2
	- max_leaf_nodes = None
	- min_impurity_decrease = 0.0
	- ccp_alpha = 0.0
	- n_features_in_ = 36
	- n_outputs_ = 1
	- classes_ = [0 1]
	- n_classes_ = 2
	- base_estimator_ = ExtraTreeClassifier()
	- oob_decision_function_ = [[0.38636364 0.61363636]
 [0.28571429 0.71428571]
 [0.36734694 0.63265306]
 [0.35555556 0.64444444]
 [0.51111111 0.48888889]
 [0.52173913 0.47826087]
 [0.89361702 0.10638298]
 [0.91666667 0.08333333]
 [0.93181818 0.06818182]
 [0.08888889 0.91111111]
 [0.65217391 0.34782609]
 [0.84782609 0.15217391]
 [0.76086957 0.23913043]
 [0.97619048 0.02380952]
 [0.95555556 0.04444444]
 [0.53191489 0.46808511]
 [0.35416667 0.64583333]
 [0.45652174 0.54347826]
 [0.92682927 0.07317073]
 [0.93333333 0.06666667]
 [0.9787234  0.0212766 ]
 [0.93617021 0.06382979]
 [0.36956522 0.63043478]
 [0.33333333 0.66666667]
 [0.3255814  0.6744186 ]
 [0.44680851 0.55319149]
 [0.65957447 0.34042553]
 [0.77777778 0.22222222]
 [0.9375     0.0625    ]
 [0.95555556 0.04444444]
 [0.24489796 0.75510204]
 [0.80434783 0.19565217]
 [0.44680851 0.55319149]
 [0.13333333 0.86666667]
 [0.2826087  0.7173913 ]
 [0.84444444 0.15555556]
 [0.89130435 0.10869565]
 [0.93478261 0.06521739]
 [0.90909091 0.09090909]
 [0.59574468 0.40425532]
 [0.63636364 0.36363636]
 [0.64444444 0.35555556]
 [0.53333333 0.46666667]
 [0.51162791 0.48837209]
 [0.875      0.125     ]
 [0.87234043 0.12765957]
 [0.8        0.2       ]
 [0.82978723 0.17021277]
 [0.36585366 0.63414634]
 [0.65116279 0.34883721]
 [0.5625     0.4375    ]
 [0.44444444 0.55555556]
 [0.45652174 0.54347826]
 [0.73913043 0.26086957]
 [0.65217391 0.34782609]
 [0.86666667 0.13333333]
 [0.54545455 0.45454545]
 [0.4        0.6       ]
 [0.31111111 0.68888889]
 [0.27659574 0.72340426]
 [0.56097561 0.43902439]
 [0.61904762 0.38095238]
 [0.75       0.25      ]
 [0.76086957 0.23913043]
 [0.77777778 0.22222222]
 [0.74468085 0.25531915]
 [0.6        0.4       ]
 [0.31914894 0.68085106]
 [0.82978723 0.17021277]
 [0.84782609 0.15217391]
 [0.9047619  0.0952381 ]
 [0.75       0.25      ]
 [0.43478261 0.56521739]
 [0.53191489 0.46808511]
 [0.34782609 0.65217391]
 [0.41304348 0.58695652]
 [0.43478261 0.56521739]
 [0.81818182 0.18181818]
 [0.95744681 0.04255319]
 [0.95652174 0.04347826]
 [0.84090909 0.15909091]
 [0.29545455 0.70454545]
 [0.20833333 0.79166667]
 [0.33333333 0.66666667]
 [0.88636364 0.11363636]
 [0.86666667 0.13333333]
 [0.91836735 0.08163265]
 [0.88372093 0.11627907]
 [0.58139535 0.41860465]
 [0.17777778 0.82222222]
 [0.19565217 0.80434783]
 [0.36170213 0.63829787]
 [0.60869565 0.39130435]
 [0.88888889 0.11111111]
 [0.88888889 0.11111111]
 [0.89130435 0.10869565]
 [0.91489362 0.08510638]
 [0.7804878  0.2195122 ]
 [0.38297872 0.61702128]
 [0.48888889 0.51111111]
 [0.54545455 0.45454545]
 [0.90697674 0.09302326]
 [0.95652174 0.04347826]
 [0.5        0.5       ]
 [0.54761905 0.45238095]
 [0.10638298 0.89361702]
 [0.95744681 0.04255319]
 [0.93617021 0.06382979]
 [0.97777778 0.02222222]
 [0.975      0.025     ]
 [0.47916667 0.52083333]
 [0.475      0.525     ]
 [0.2173913  0.7826087 ]
 [0.40425532 0.59574468]
 [0.25581395 0.74418605]
 [0.25581395 0.74418605]
 [0.17391304 0.82608696]
 [0.28888889 0.71111111]
 [0.3125     0.6875    ]
 [0.23913043 0.76086957]
 [0.2173913  0.7826087 ]
 [0.41304348 0.58695652]
 [0.2        0.8       ]
 [0.2        0.8       ]
 [0.25       0.75      ]
 [0.29545455 0.70454545]
 [0.48888889 0.51111111]
 [0.35555556 0.64444444]
 [0.24489796 0.75510204]
 [0.29166667 0.70833333]
 [0.35897436 0.64102564]
 [0.26086957 0.73913043]
 [0.47826087 0.52173913]
 [0.16666667 0.83333333]
 [0.14893617 0.85106383]
 [0.36170213 0.63829787]
 [0.19047619 0.80952381]
 [0.38297872 0.61702128]
 [0.1875     0.8125    ]
 [0.23404255 0.76595745]
 [0.38297872 0.61702128]
 [0.29545455 0.70454545]
 [0.2173913  0.7826087 ]
 [0.22916667 0.77083333]
 [0.21276596 0.78723404]
 [0.26086957 0.73913043]
 [0.25581395 0.74418605]
 [0.2        0.8       ]
 [0.19565217 0.80434783]
 [0.08510638 0.91489362]
 [0.15217391 0.84782609]
 [0.27659574 0.72340426]
 [0.37209302 0.62790698]
 [0.15555556 0.84444444]
 [0.31111111 0.68888889]
 [0.23913043 0.76086957]
 [0.19148936 0.80851064]
 [0.23404255 0.76595745]
 [0.31914894 0.68085106]
 [0.1875     0.8125    ]
 [0.53061224 0.46938776]
 [0.24444444 0.75555556]
 [0.31111111 0.68888889]
 [0.57446809 0.42553191]
 [0.33333333 0.66666667]
 [0.1        0.9       ]
 [0.10869565 0.89130435]
 [0.39130435 0.60869565]
 [0.34090909 0.65909091]
 [0.22222222 0.77777778]
 [0.15217391 0.84782609]
 [0.63636364 0.36363636]
 [0.17021277 0.82978723]
 [0.32608696 0.67391304]
 [0.34146341 0.65853659]
 [0.16666667 0.83333333]
 [0.2173913  0.7826087 ]
 [0.17777778 0.82222222]
 [0.27659574 0.72340426]
 [0.19148936 0.80851064]
 [0.26666667 0.73333333]
 [0.23913043 0.76086957]
 [0.20454545 0.79545455]
 [0.26086957 0.73913043]]
	- oob_score_ = 0.8369565217391305

#### Importance of features
- gp_auc_min = 0.0898688200027486
- high_power = 0.08279598124939033
- diff_auc = 0.06333893698893699
- srmr = 0.05291474448671418
- gp_max_val_min = 0.04221034609129847
- hlbr = 0.04076741701860749
- gp_max_val_max = 0.03570532094168458
- ac_auc = 0.03534105224581415
- gp_auc_max = 0.035272435236720946
- tdoa_max = 0.03312273528940195
- ratio_max_to_10ms_ave_peaks = 0.03185927996966958
- gp_max_val_std = 0.031756152253230176
- gp_auc_std = 0.031633170136741565
- ac_std = 0.0285818599390028
- gp_max_ix_min = 0.028554243970315397
- gp_max_val_mean = 0.027660121888693313
- gp_max_ix_std = 0.02696916672392863
- diff_std = 0.026168590668590664
- gp_auc_mean = 0.024836527141289044
- gp_max_ix_max = 0.021941297899631236
- tdoa_mean = 0.02155403238736572
- coe3[2] = 0.020862674362674357
- low_power = 0.02043400948097918
- tdoa_range = 0.019893017476350812
- gp_max_val_range = 0.018772660276231704
- tdoa_std = 0.017403572521754333
- coe3[3] = 0.016495530703864038
- ratio_max_to_9th_ave_peaks = 0.014263038548752837
- gp_max_ix_range = 0.01112173752173752
- coe1[0] = 0.010747775372775372
- gp_auc_range = 0.010721315192743764
- gp_max_ix_mean = 0.010509261263427931
- tdoa_min = 0.009453117028874605
- coe1[1] = 0.006470057720057718
- coe3[0] = 0.0
- coe3[1] = 0.0

## Evaluation
cv = 8
### accuracy
- Scores = [ 0.6206896551724138, 0.75, 0.7142857142857143, 0.6785714285714286, 0.7857142857142857, 0.7142857142857143, 0.8928571428571429, 0.7857142857142857 ]
- Mean = 0.7427647783251232
- Standard deviation = 0.07657889944030892

### balanced_accuracy
- Scores = [ 0.5760869565217391, 0.7803030303030303, 0.6363636363636364, 0.6742424242424242, 0.8636363636363636, 0.8260869565217391, 0.9347826086956521, 0.8695652173913043 ]
- Mean = 0.7701333992094862
- Standard deviation = 0.1192248534451749

### f1
- Scores = [ 0.3529411764705882, 0.5882352941176471, 0.42857142857142855, 0.4705882352941177, 0.6666666666666666, 0.5555555555555556, 0.7692307692307693, 0.625 ]
- Mean = 0.5570986407383467
- Standard deviation = 0.12662504879734737

### Confusion Matrix
|  | Predicted Negative | Predicted Positive |
| --- | --- | --- |
| Actual Negative | 130 | 50 |
| Actual Positive | 8 | 37 |

      