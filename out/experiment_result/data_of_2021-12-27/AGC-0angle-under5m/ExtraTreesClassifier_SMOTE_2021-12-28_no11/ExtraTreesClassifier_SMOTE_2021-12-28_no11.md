# ExtraTreesClassifier_SMOTE_2021-12-28_no11
## Constants
- CSV_PATH = ../out/csv/experiment
- OUTPUT_PATH = ../out/experiment_result/data_of_2021-12-27/AGC-0angle-under5m
- FEATURE_ATTRBS = ['low_power', 'high_power', 'hlbr', 'coe1[0]', 'coe1[1]', 'coe3[0]', 'coe3[1]', 'coe3[2]', 'coe3[3]', 'ratio_max_to_10ms_ave_peaks', 'ratio_max_to_9th_ave_peaks', 'ac_std', 'ac_auc', 'diff_std', 'diff_auc', 'srmr', 'gp_max_val_std', 'gp_max_val_range', 'gp_max_val_min', 'gp_max_val_max', 'gp_max_val_mean', 'gp_max_ix_std', 'gp_max_ix_range', 'gp_max_ix_min', 'gp_max_ix_max', 'gp_max_ix_mean', 'gp_auc_std', 'gp_auc_range', 'gp_auc_min', 'gp_auc_max', 'gp_auc_mean', 'tdoa_std', 'tdoa_range', 'tdoa_min', 'tdoa_max', 'tdoa_mean']
- LABEL_ATTRB = ['facing']
- FACING_DOV_ANGLES = [1]
- NCV = 8
- SCORING = ['accuracy', 'balanced_accuracy', 'f1']
- REFIT_SCORING = balanced_accuracy
- PARAM_GRID = [{'est__n_estimators': [50, 100, 150, 200, 300], 'est__min_samples_split': [2, 5, 10], 'est__min_samples_leaf': [1, 5, 10], 'est__max_features': ['sqrt', 'log2', None], 'est__bootstrap': [False], 'est__n_jobs': [-1], 'est__random_state': [42], 'est__max_samples': [0.01, 0.5, 0.09]}, {'est__n_estimators': [50, 100, 150, 200, 300], 'est__min_samples_split': [2, 5, 10], 'est__min_samples_leaf': [1, 5, 10], 'est__max_features': ['sqrt', 'log2', None], 'est__bootstrap': [True], 'est__oob_score': [True, False], 'est__n_jobs': [-1], 'est__random_state': [42], 'est__max_samples': [0.01, 0.5, 0.09]}]
- TRAIN_SET_SESSION = ['trial1', 'trial2']
- TEST_SET_SESSION = ['trial3', 'trial4', 'trial5']
- DISTANCE = [1, 3, 5]
- AGC_STATUS = ['AGC']

## Loaded CSV
- 2021-12-27_raspi_48000Hz_w1_N2^12_overlap80_new.csv

## Estimator
### Type
- resampler = SMOTE
- estimator = ExtraTreesClassifier

### Arguments for hyperparameter search
- resampler = SMOTE
- estimator = ExtraTreesClassifier
- param_grid = 
	- {'est__n_estimators': [50, 100, 150, 200, 300], 'est__min_samples_split': [2, 5, 10], 'est__min_samples_leaf': [1, 5, 10], 'est__max_features': ['sqrt', 'log2', None], 'est__bootstrap': [False], 'est__n_jobs': [-1], 'est__random_state': [42], 'est__max_samples': [0.01, 0.5, 0.09]}
	- {'est__n_estimators': [50, 100, 150, 200, 300], 'est__min_samples_split': [2, 5, 10], 'est__min_samples_leaf': [1, 5, 10], 'est__max_features': ['sqrt', 'log2', None], 'est__bootstrap': [True], 'est__oob_score': [True, False], 'est__n_jobs': [-1], 'est__random_state': [42], 'est__max_samples': [0.01, 0.5, 0.09]}

- scoring = ['accuracy', 'balanced_accuracy', 'f1']
- refit = balanced_accuracy
- cv = 8

### Parameters of the best estimator
#### The best hyper-parameters
- best_resampler
	- sampling_strategy = auto
	- random_state = 42
	- k_neighbors = 5
	- n_jobs = -1
	- n_features_in_ = 36
	- sampling_strategy_ = OrderedDict([(1, 88)])
	- nn_k_ = NearestNeighbors(n_neighbors=6)

- best_estimator
	- base_estimator = ExtraTreeClassifier()
	- n_estimators = 200
	- estimator_params = ('criterion', 'max_depth', 'min_samples_split', 'min_samples_leaf', 'min_weight_fraction_leaf', 'max_features', 'max_leaf_nodes', 'min_impurity_decrease', 'min_impurity_split', 'random_state', 'ccp_alpha')
	- bootstrap = True
	- oob_score = True
	- n_jobs = -1
	- random_state = 42
	- verbose = 0
	- warm_start = False
	- class_weight = None
	- max_samples = 0.09
	- criterion = gini
	- max_depth = None
	- min_samples_split = 2
	- min_samples_leaf = 5
	- min_weight_fraction_leaf = 0.0
	- max_features = log2
	- max_leaf_nodes = None
	- min_impurity_decrease = 0.0
	- min_impurity_split = None
	- ccp_alpha = 0.0
	- n_features_in_ = 36
	- n_features_ = 36
	- n_outputs_ = 1
	- classes_ = [0 1]
	- n_classes_ = 2
	- base_estimator_ = ExtraTreeClassifier()
	- oob_decision_function_ = [[0.52781235 0.47218765]
 [0.51843484 0.48156516]
 [0.50057984 0.49942016]
 [0.50156046 0.49843954]
 [0.45593637 0.54406363]
 [0.45198475 0.54801525]
 [0.70754298 0.29245702]
 [0.70568987 0.29431013]
 [0.72739544 0.27260456]
 [0.73933644 0.26066356]
 [0.3982222  0.6017778 ]
 [0.40784315 0.59215685]
 [0.47347724 0.52652276]
 [0.36486135 0.63513865]
 [0.61972314 0.38027686]
 [0.52595301 0.47404699]
 [0.75808336 0.24191664]
 [0.73571459 0.26428541]
 [0.68270555 0.31729445]
 [0.67662948 0.32337052]
 [0.47744085 0.52255915]
 [0.4334693  0.5665307 ]
 [0.65398769 0.34601231]
 [0.51559648 0.48440352]
 [0.69793306 0.30206694]
 [0.59665755 0.40334245]
 [0.75384747 0.24615253]
 [0.73987061 0.26012939]
 [0.72355623 0.27644377]
 [0.73559541 0.26440459]
 [0.51385586 0.48614414]
 [0.52078991 0.47921009]
 [0.52084368 0.47915632]
 [0.52002713 0.47997287]
 [0.48757355 0.51242645]
 [0.47999645 0.52000355]
 [0.55206204 0.44793796]
 [0.59073655 0.40926345]
 [0.7398006  0.2601994 ]
 [0.73285678 0.26714322]
 [0.56700471 0.43299529]
 [0.55378476 0.44621524]
 [0.38142035 0.61857965]
 [0.3020218  0.6979782 ]
 [0.39671773 0.60328227]
 [0.32341825 0.67658175]
 [0.6289408  0.3710592 ]
 [0.61357252 0.38642748]
 [0.74912021 0.25087979]
 [0.75670942 0.24329058]
 [0.53408627 0.46591373]
 [0.49404754 0.50595246]
 [0.59964297 0.40035703]
 [0.41246147 0.58753853]
 [0.43503654 0.56496346]
 [0.40010198 0.59989802]
 [0.67325421 0.32674579]
 [0.61632071 0.38367929]
 [0.69849429 0.30150571]
 [0.67144976 0.32855024]
 [0.65371729 0.34628271]
 [0.6616022  0.3383978 ]
 [0.51733808 0.48266192]
 [0.50935444 0.49064556]
 [0.47852609 0.52147391]
 [0.47140105 0.52859895]
 [0.42157223 0.57842777]
 [0.43601041 0.56398959]
 [0.56207478 0.43792522]
 [0.50369557 0.49630443]
 [0.68896154 0.31103846]
 [0.67814405 0.32185595]
 [0.53828077 0.46171923]
 [0.43563668 0.56436332]
 [0.30289035 0.69710965]
 [0.31232511 0.68767489]
 [0.38482062 0.61517938]
 [0.3746994  0.6253006 ]
 [0.61841166 0.38158834]
 [0.57849713 0.42150287]
 [0.70248424 0.29751576]
 [0.70048624 0.29951376]
 [0.67807556 0.32192444]
 [0.55021736 0.44978264]
 [0.40846781 0.59153219]
 [0.37561748 0.62438252]
 [0.51188588 0.48811412]
 [0.4548978  0.5451022 ]
 [0.64063341 0.35936659]
 [0.67502832 0.32497168]
 [0.71923852 0.28076148]
 [0.71716984 0.28283016]
 [0.56589932 0.43410068]
 [0.62938324 0.37061676]
 [0.485822   0.514178  ]
 [0.4501844  0.5498156 ]
 [0.37978677 0.62021323]
 [0.40317562 0.59682438]
 [0.42901899 0.57098101]
 [0.43816265 0.56183735]
 [0.72738145 0.27261855]
 [0.75970827 0.24029173]
 [0.69715886 0.30284114]
 [0.62918457 0.37081543]
 [0.37260661 0.62739339]
 [0.31315872 0.68684128]
 [0.30226675 0.69773325]
 [0.30408215 0.69591785]
 [0.37221622 0.62778378]
 [0.31878036 0.68121964]
 [0.74269038 0.25730962]
 [0.73683438 0.26316562]
 [0.72590721 0.27409279]
 [0.71846805 0.28153195]
 [0.53558307 0.46441693]
 [0.50540079 0.49459921]
 [0.38626032 0.61373968]
 [0.43331007 0.56668993]
 [0.47151238 0.52848762]
 [0.55161596 0.44838404]
 [0.73818938 0.26181062]
 [0.74505235 0.25494765]
 [0.73620978 0.26379022]
 [0.7321894  0.2678106 ]
 [0.6321057  0.3678943 ]
 [0.63157825 0.36842175]
 [0.40866518 0.59133482]
 [0.43154747 0.56845253]
 [0.40774743 0.59225257]
 [0.40961995 0.59038005]
 [0.74007784 0.25992216]
 [0.77230649 0.22769351]
 [0.69197391 0.30802609]
 [0.62893486 0.37106514]
 [0.3769938  0.6230062 ]
 [0.40340991 0.59659009]
 [0.32199125 0.67800875]
 [0.29846755 0.70153245]
 [0.74259046 0.25740954]
 [0.75083501 0.24916499]
 [0.76962761 0.23037239]
 [0.76385035 0.23614965]
 [0.70534809 0.29465191]
 [0.68154979 0.31845021]
 [0.50492788 0.49507212]
 [0.51994383 0.48005617]
 [0.38395687 0.61604313]
 [0.4277222  0.5722778 ]
 [0.3068374  0.6931626 ]
 [0.37833537 0.62166463]
 [0.39146192 0.60853808]
 [0.31741324 0.68258676]
 [0.33414403 0.66585597]
 [0.39763672 0.60236328]
 [0.29113082 0.70886918]
 [0.40012316 0.59987684]
 [0.32240964 0.67759036]
 [0.4158521  0.5841479 ]
 [0.40368344 0.59631656]
 [0.40423949 0.59576051]
 [0.38379723 0.61620277]
 [0.31081176 0.68918824]
 [0.37534876 0.62465124]
 [0.3251054  0.6748946 ]
 [0.53027563 0.46972437]
 [0.41786898 0.58213102]
 [0.53479857 0.46520143]
 [0.3784968  0.6215032 ]
 [0.3631504  0.6368496 ]
 [0.41059994 0.58940006]
 [0.48236111 0.51763889]
 [0.37435309 0.62564691]
 [0.3064669  0.6935331 ]
 [0.34961052 0.65038948]
 [0.36164372 0.63835628]
 [0.48425292 0.51574708]
 [0.29856942 0.70143058]
 [0.42504297 0.57495703]
 [0.52056249 0.47943751]
 [0.30348236 0.69651764]
 [0.57295145 0.42704855]
 [0.36760135 0.63239865]
 [0.44112208 0.55887792]
 [0.30850095 0.69149905]
 [0.37264308 0.62735692]
 [0.30414796 0.69585204]
 [0.41527833 0.58472167]
 [0.31795378 0.68204622]
 [0.40785928 0.59214072]
 [0.49626223 0.50373777]
 [0.37514029 0.62485971]
 [0.32614323 0.67385677]
 [0.3887334  0.6112666 ]
 [0.33355133 0.66644867]
 [0.37302527 0.62697473]
 [0.37826578 0.62173422]
 [0.5165039  0.4834961 ]
 [0.48051835 0.51948165]
 [0.30107749 0.69892251]
 [0.29108499 0.70891501]
 [0.39912202 0.60087798]
 [0.29719554 0.70280446]
 [0.52742956 0.47257044]
 [0.31619416 0.68380584]
 [0.48135012 0.51864988]
 [0.46637271 0.53362729]
 [0.5257984  0.4742016 ]
 [0.42963143 0.57036857]
 [0.39597237 0.60402763]
 [0.35945667 0.64054333]
 [0.39890671 0.60109329]
 [0.30599979 0.69400021]
 [0.30759691 0.69240309]
 [0.35841131 0.64158869]
 [0.50793861 0.49206139]
 [0.34846075 0.65153925]
 [0.38135338 0.61864662]
 [0.36165725 0.63834275]
 [0.34084373 0.65915627]
 [0.40906775 0.59093225]
 [0.3593578  0.6406422 ]
 [0.32565147 0.67434853]
 [0.37142348 0.62857652]
 [0.51054776 0.48945224]
 [0.39855919 0.60144081]
 [0.29505968 0.70494032]
 [0.52459533 0.47540467]
 [0.40421846 0.59578154]
 [0.3676612  0.6323388 ]
 [0.29681564 0.70318436]
 [0.51242192 0.48757808]
 [0.3143041  0.6856959 ]
 [0.30665207 0.69334793]
 [0.28257339 0.71742661]
 [0.52116314 0.47883686]
 [0.41941294 0.58058706]]
	- oob_score_ = 0.8008474576271186

#### Importance of features
- diff_auc = 0.07211328388833536
- gp_max_val_min = 0.06948703755401925
- gp_auc_min = 0.06664628751257916
- gp_auc_mean = 0.06435100592711618
- gp_auc_max = 0.05794053300216621
- gp_max_val_mean = 0.05297997041769084
- diff_std = 0.04693783259039155
- high_power = 0.04318451873988363
- tdoa_mean = 0.034945016745641495
- coe3[2] = 0.03486214613674392
- coe1[1] = 0.03320580891870523
- srmr = 0.032452336031391533
- coe1[0] = 0.02891532117591833
- hlbr = 0.02800534737574632
- gp_auc_std = 0.02687310022704689
- ac_auc = 0.026384448448873766
- tdoa_range = 0.02373381128584644
- gp_max_ix_mean = 0.023288092293166553
- gp_max_val_max = 0.022345238711681856
- gp_max_ix_min = 0.021983996083391622
- ratio_max_to_9th_ave_peaks = 0.01932592549770968
- ac_std = 0.019129002138463743
- tdoa_min = 0.01745165138000414
- tdoa_max = 0.01734300327255567
- gp_auc_range = 0.016134353102956304
- low_power = 0.015124654491432245
- coe3[3] = 0.013841787533330084
- gp_max_ix_std = 0.01290250881261748
- ratio_max_to_10ms_ave_peaks = 0.012472563419001258
- gp_max_val_std = 0.011262474909812862
- gp_max_ix_max = 0.010589485510261464
- tdoa_std = 0.009052913151900967
- gp_max_ix_range = 0.007598643992644023
- gp_max_val_range = 0.007135899720973913
- coe3[0] = 0.0
- coe3[1] = 0.0

## Evaluation
cv = 8
### accuracy
- Scores = [ 0.6071428571428571, 0.75, 0.7142857142857143, 0.6071428571428571, 0.7142857142857143, 0.5, 0.7142857142857143, 0.8571428571428571 ]
- Mean = 0.6830357142857143
- Standard deviation = 0.10170344419548677

### balanced_accuracy
- Scores = [ 0.6287878787878788, 0.8409090909090908, 0.696969696969697, 0.75, 0.8181818181818181, 0.6956521739130435, 0.7478260869565218, 0.7565217391304347 ]
- Mean = 0.7418560606060607
- Standard deviation = 0.06411724582502201

### f1
- Scores = [ 0.42105263157894735, 0.631578947368421, 0.5, 0.5217391304347826, 0.6, 0.4166666666666667, 0.5000000000000001, 0.6 ]
- Mean = 0.5238796720061023
- Standard deviation = 0.07615841280412154

### Confusion Matrix
|  | Predicted Negative | Predicted Positive |
| --- | --- | --- |
| Actual Negative | 115 | 64 |
| Actual Positive | 7 | 38 |

      