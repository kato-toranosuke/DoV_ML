# ExtraTreesClassifier_RandomOverSampler_2021-12-28_no10
## Constants
- CSV_PATH = ../out/csv/experiment
- OUTPUT_PATH = ../out/experiment_result/data_of_2021-12-27/AGC-0angle-under5m
- FEATURE_ATTRBS = ['low_power', 'high_power', 'hlbr', 'coe1[0]', 'coe1[1]', 'coe3[0]', 'coe3[1]', 'coe3[2]', 'coe3[3]', 'ratio_max_to_10ms_ave_peaks', 'ratio_max_to_9th_ave_peaks', 'ac_std', 'ac_auc', 'diff_std', 'diff_auc', 'srmr', 'gp_max_val_std', 'gp_max_val_range', 'gp_max_val_min', 'gp_max_val_max', 'gp_max_val_mean', 'gp_max_ix_std', 'gp_max_ix_range', 'gp_max_ix_min', 'gp_max_ix_max', 'gp_max_ix_mean', 'gp_auc_std', 'gp_auc_range', 'gp_auc_min', 'gp_auc_max', 'gp_auc_mean', 'tdoa_std', 'tdoa_range', 'tdoa_min', 'tdoa_max', 'tdoa_mean']
- LABEL_ATTRB = ['facing']
- FACING_DOV_ANGLES = [1]
- NCV = 8
- SCORING = ['accuracy', 'balanced_accuracy', 'f1']
- REFIT_SCORING = balanced_accuracy
- PARAM_GRID = [{'est__n_estimators': [50, 100, 150, 200, 300], 'est__min_samples_split': [2, 5, 10], 'est__min_samples_leaf': [1, 5, 10], 'est__max_features': ['sqrt', 'log2', None], 'est__bootstrap': [False], 'est__n_jobs': [-1], 'est__random_state': [42], 'est__max_samples': [0.01, 0.5, 0.09]}, {'est__n_estimators': [50, 100, 150, 200, 300], 'est__min_samples_split': [2, 5, 10], 'est__min_samples_leaf': [1, 5, 10], 'est__max_features': ['sqrt', 'log2', None], 'est__bootstrap': [True], 'est__oob_score': [True, False], 'est__n_jobs': [-1], 'est__random_state': [42], 'est__max_samples': [0.01, 0.5, 0.09]}]
- TRAIN_SET_SESSION = ['trial1', 'trial2']
- TEST_SET_SESSION = ['trial3', 'trial4', 'trial5']
- DISTANCE = [1, 3, 5]
- AGC_STATUS = ['AGC']

## Loaded CSV
- 2021-12-27_raspi_48000Hz_w1_N2^12_overlap80_new.csv

## Estimator
### Type
- resampler = RandomOverSampler
- estimator = ExtraTreesClassifier

### Arguments for hyperparameter search
- resampler = RandomOverSampler
- estimator = ExtraTreesClassifier
- param_grid = 
	- {'est__n_estimators': [50, 100, 150, 200, 300], 'est__min_samples_split': [2, 5, 10], 'est__min_samples_leaf': [1, 5, 10], 'est__max_features': ['sqrt', 'log2', None], 'est__bootstrap': [False], 'est__n_jobs': [-1], 'est__random_state': [42], 'est__max_samples': [0.01, 0.5, 0.09]}
	- {'est__n_estimators': [50, 100, 150, 200, 300], 'est__min_samples_split': [2, 5, 10], 'est__min_samples_leaf': [1, 5, 10], 'est__max_features': ['sqrt', 'log2', None], 'est__bootstrap': [True], 'est__oob_score': [True, False], 'est__n_jobs': [-1], 'est__random_state': [42], 'est__max_samples': [0.01, 0.5, 0.09]}

- scoring = ['accuracy', 'balanced_accuracy', 'f1']
- refit = balanced_accuracy
- cv = 8

### Parameters of the best estimator
#### The best hyper-parameters
- best_resampler
	- sampling_strategy = auto
	- random_state = 42
	- shrinkage = None
	- n_features_in_ = 36
	- sampling_strategy_ = OrderedDict([(1, 88)])
	- shrinkage_ = None
	- sample_indices_ = [  0   1   2   3   4   5   6   7   8   9  10  11  12  13  14  15  16  17
  18  19  20  21  22  23  24  25  26  27  28  29  30  31  32  33  34  35
  36  37  38  39  40  41  42  43  44  45  46  47  48  49  50  51  52  53
  54  55  56  57  58  59  60  61  62  63  64  65  66  67  68  69  70  71
  72  73  74  75  76  77  78  79  80  81  82  83  84  85  86  87  88  89
  90  91  92  93  94  95  96  97  98  99 100 101 102 103 104 105 106 107
 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125
 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143
 144 145 146 147  32  97 146  74  52  33 146 106  32 129  96 116  52  52
 117 106  11  33 117  10 107 106   1 117  53 147  21   1 137 106   0  53
 129 107 146  53 128  84 136 136  43 137 137  75  74 147 147  74 147  96
  53 116  97 128  10  20  96  32 106  42  32  85  11 128 137  65  85 129
  42 129 106   1  97 137  74 137  32  53 146  33  74  10  65  84  11  85
  33  11]

- best_estimator
	- base_estimator = ExtraTreeClassifier()
	- n_estimators = 150
	- estimator_params = ('criterion', 'max_depth', 'min_samples_split', 'min_samples_leaf', 'min_weight_fraction_leaf', 'max_features', 'max_leaf_nodes', 'min_impurity_decrease', 'min_impurity_split', 'random_state', 'ccp_alpha')
	- bootstrap = True
	- oob_score = True
	- n_jobs = -1
	- random_state = 42
	- verbose = 0
	- warm_start = False
	- class_weight = None
	- max_samples = 0.09
	- criterion = gini
	- max_depth = None
	- min_samples_split = 10
	- min_samples_leaf = 1
	- min_weight_fraction_leaf = 0.0
	- max_features = log2
	- max_leaf_nodes = None
	- min_impurity_decrease = 0.0
	- min_impurity_split = None
	- ccp_alpha = 0.0
	- n_features_in_ = 36
	- n_features_ = 36
	- n_outputs_ = 1
	- classes_ = [0 1]
	- n_classes_ = 2
	- base_estimator_ = ExtraTreeClassifier()
	- oob_decision_function_ = [[0.4452192  0.5547808 ]
 [0.42558888 0.57441112]
 [0.43299964 0.56700036]
 [0.44704922 0.55295078]
 [0.3795947  0.6204053 ]
 [0.41580139 0.58419861]
 [0.83661699 0.16338301]
 [0.8334304  0.1665696 ]
 [0.86950196 0.13049804]
 [0.86243386 0.13756614]
 [0.38582818 0.61417182]
 [0.39575421 0.60424579]
 [0.47017823 0.52982177]
 [0.39886714 0.60113286]
 [0.66010022 0.33989978]
 [0.52830243 0.47169757]
 [0.91346331 0.08653669]
 [0.91193927 0.08806073]
 [0.82922271 0.17077729]
 [0.83038997 0.16961003]
 [0.50875328 0.49124672]
 [0.3928151  0.6071849 ]
 [0.78368415 0.21631585]
 [0.62421829 0.37578171]
 [0.8209429  0.1790571 ]
 [0.7215942  0.2784058 ]
 [0.89352133 0.10647867]
 [0.90301412 0.09698588]
 [0.88701978 0.11298022]
 [0.88627332 0.11372668]
 [0.43337095 0.56662905]
 [0.42792849 0.57207151]
 [0.41322348 0.58677652]
 [0.4462543  0.5537457 ]
 [0.42487147 0.57512853]
 [0.44189096 0.55810904]
 [0.55810001 0.44189999]
 [0.66909297 0.33090703]
 [0.89155983 0.10844017]
 [0.87371104 0.12628896]
 [0.6274218  0.3725782 ]
 [0.60921286 0.39078714]
 [0.37666476 0.62333524]
 [0.24061885 0.75938115]
 [0.42004654 0.57995346]
 [0.26391043 0.73608957]
 [0.68049337 0.31950663]
 [0.66735412 0.33264588]
 [0.92799662 0.07200338]
 [0.92226925 0.07773075]
 [0.50667096 0.49332904]
 [0.50084841 0.49915159]
 [0.62055493 0.37944507]
 [0.37753479 0.62246521]
 [0.46750049 0.53249951]
 [0.37335638 0.62664362]
 [0.77902506 0.22097494]
 [0.72036005 0.27963995]
 [0.86023467 0.13976533]
 [0.84121637 0.15878363]
 [0.67553005 0.32446995]
 [0.69900498 0.30099502]
 [0.45844051 0.54155949]
 [0.46754865 0.53245135]
 [0.45844465 0.54155535]
 [0.42008716 0.57991284]
 [0.35045094 0.64954906]
 [0.37525948 0.62474052]
 [0.6259546  0.3740454 ]
 [0.56392365 0.43607635]
 [0.84569665 0.15430335]
 [0.81838435 0.18161565]
 [0.58917108 0.41082892]
 [0.47396784 0.52603216]
 [0.24114667 0.75885333]
 [0.26301572 0.73698428]
 [0.36821815 0.63178185]
 [0.38437049 0.61562951]
 [0.69710097 0.30289903]
 [0.66070553 0.33929447]
 [0.87706349 0.12293651]
 [0.84100915 0.15899085]
 [0.81496116 0.18503884]
 [0.6889631  0.3110369 ]
 [0.36464189 0.63535811]
 [0.26689335 0.73310665]
 [0.52459806 0.47540194]
 [0.42152866 0.57847134]
 [0.77789623 0.22210377]
 [0.83462721 0.16537279]
 [0.84534014 0.15465986]
 [0.87134921 0.12865079]
 [0.57423775 0.42576225]
 [0.67697816 0.32302184]
 [0.44099636 0.55900364]
 [0.38665401 0.61334599]
 [0.2678891  0.7321109 ]
 [0.30742927 0.69257073]
 [0.43423817 0.56576183]
 [0.356633   0.643367  ]
 [0.81834734 0.18165266]
 [0.89350907 0.10649093]
 [0.79758167 0.20241833]
 [0.71495661 0.28504339]
 [0.33398847 0.66601153]
 [0.25273182 0.74726818]
 [0.2631802  0.7368198 ]
 [0.25083208 0.74916792]
 [0.42294876 0.57705124]
 [0.29620877 0.70379123]
 [0.90417695 0.09582305]
 [0.88678571 0.11321429]
 [0.88674268 0.11325732]
 [0.86827098 0.13172902]
 [0.62539736 0.37460264]
 [0.5513155  0.4486845 ]
 [0.2967773  0.7032227 ]
 [0.30472941 0.69527059]
 [0.43164042 0.56835958]
 [0.61254477 0.38745523]
 [0.85880333 0.14119667]
 [0.83800737 0.16199263]
 [0.85825857 0.14174143]
 [0.79736332 0.20263668]
 [0.64126984 0.35873016]
 [0.63274698 0.36725302]
 [0.35099366 0.64900634]
 [0.38067678 0.61932322]
 [0.35668372 0.64331628]
 [0.29598227 0.70401773]
 [0.85971465 0.14028535]
 [0.89510675 0.10489325]
 [0.76219519 0.23780481]
 [0.66034349 0.33965651]
 [0.32428369 0.67571631]
 [0.32781147 0.67218853]
 [0.30842253 0.69157747]
 [0.22808766 0.77191234]
 [0.89490079 0.10509921]
 [0.89693836 0.10306164]
 [0.91946145 0.08053855]
 [0.91731113 0.08268887]
 [0.86926173 0.13073827]
 [0.85207483 0.14792517]
 [0.53775397 0.46224603]
 [0.5770019  0.4229981 ]
 [0.3165595  0.6834405 ]
 [0.41053899 0.58946101]
 [0.42515338 0.57484662]
 [0.28857581 0.71142419]
 [0.31321241 0.68678759]
 [0.23802967 0.76197033]
 [0.62461493 0.37538507]
 [0.44872901 0.55127099]
 [0.29854579 0.70145421]
 [0.26465742 0.73534258]
 [0.42495935 0.57504065]
 [0.28722677 0.71277323]
 [0.25890301 0.74109699]
 [0.29267934 0.70732066]
 [0.60561843 0.39438157]
 [0.6149032  0.3850968 ]
 [0.28739523 0.71260477]
 [0.26085091 0.73914909]
 [0.38754542 0.61245458]
 [0.45378269 0.54621731]
 [0.29936763 0.70063237]
 [0.38923372 0.61076628]
 [0.25252471 0.74747529]
 [0.26151828 0.73848172]
 [0.4331824  0.5668176 ]
 [0.29198719 0.70801281]
 [0.3885842  0.6114158 ]
 [0.40624713 0.59375287]
 [0.40492934 0.59507066]
 [0.43176407 0.56823593]
 [0.23158241 0.76841759]
 [0.26738313 0.73261687]
 [0.42120542 0.57879458]
 [0.37491808 0.62508192]
 [0.29073937 0.70926063]
 [0.24970782 0.75029218]
 [0.30890838 0.69109162]
 [0.393724   0.606276  ]
 [0.36786377 0.63213623]
 [0.37522839 0.62477161]
 [0.31420619 0.68579381]
 [0.3143608  0.6856392 ]
 [0.23612131 0.76387869]
 [0.23365534 0.76634466]
 [0.22104501 0.77895499]
 [0.26123999 0.73876001]
 [0.25064127 0.74935873]
 [0.41013975 0.58986025]
 [0.42361045 0.57638955]
 [0.2462216  0.7537784 ]
 [0.41444577 0.58555423]
 [0.27546261 0.72453739]
 [0.40765126 0.59234874]
 [0.30316886 0.69683114]
 [0.29234434 0.70765566]
 [0.3451158  0.6548842 ]
 [0.39387918 0.60612082]
 [0.5125818  0.4874182 ]
 [0.27760763 0.72239237]
 [0.42264902 0.57735098]
 [0.26296614 0.73703386]
 [0.3784766  0.6215234 ]
 [0.4222649  0.5777351 ]
 [0.26077857 0.73922143]
 [0.39384133 0.60615867]
 [0.35150613 0.64849387]
 [0.23612488 0.76387512]
 [0.3980749  0.6019251 ]
 [0.2875768  0.7124232 ]
 [0.28953875 0.71046125]
 [0.36662003 0.63337997]
 [0.29308382 0.70691618]
 [0.26136694 0.73863306]
 [0.43621479 0.56378521]
 [0.28899898 0.71100102]
 [0.22580701 0.77419299]
 [0.24311662 0.75688338]
 [0.22772722 0.77227278]
 [0.43320574 0.56679426]
 [0.40104669 0.59895331]
 [0.30367498 0.69632502]
 [0.44640348 0.55359652]
 [0.23830108 0.76169892]
 [0.39806174 0.60193826]
 [0.40279839 0.59720161]
 [0.36440816 0.63559184]
 [0.3978813  0.6021187 ]
 [0.27842201 0.72157799]
 [0.43529458 0.56470542]
 [0.41211556 0.58788444]]
	- oob_score_ = 0.826271186440678

#### Importance of features
- gp_auc_min = 0.08239887279613273
- gp_auc_max = 0.06556631595850428
- coe1[0] = 0.06464585444459782
- gp_max_val_mean = 0.061112057973695094
- high_power = 0.06024577007335558
- diff_auc = 0.05999256809958695
- gp_max_val_min = 0.05988242246278611
- gp_auc_mean = 0.05230119911916521
- gp_max_val_max = 0.0481168684747303
- coe1[1] = 0.03966920754263635
- srmr = 0.038989909920437105
- ac_auc = 0.03684691638413603
- low_power = 0.03302311480796137
- diff_std = 0.03295450714034979
- ratio_max_to_10ms_ave_peaks = 0.025478349991557906
- ac_std = 0.023314415924018648
- gp_max_val_std = 0.020523185810716573
- hlbr = 0.01855980683897126
- coe3[3] = 0.018307881744740153
- gp_max_val_range = 0.01660083834807271
- ratio_max_to_9th_ave_peaks = 0.01342791509582401
- gp_max_ix_min = 0.01255707069109169
- tdoa_min = 0.012283716415554658
- coe3[2] = 0.01205188987742045
- gp_max_ix_mean = 0.011868575464081295
- gp_auc_std = 0.011810495630517599
- tdoa_mean = 0.01073412721965096
- tdoa_max = 0.010416372919983962
- tdoa_std = 0.00957316672193797
- gp_max_ix_std = 0.009383322698415504
- tdoa_range = 0.00882745747603545
- gp_max_ix_max = 0.007411022146855512
- gp_max_ix_range = 0.0056040338677483745
- gp_auc_range = 0.005520769918730731
- coe3[0] = 0.0
- coe3[1] = 0.0

## Evaluation
cv = 8
### accuracy
- Scores = [ 0.6071428571428571, 0.75, 0.7142857142857143, 0.7142857142857143, 0.7142857142857143, 0.6071428571428571, 0.75, 0.7857142857142857 ]
- Mean = 0.7053571428571428
- Standard deviation = 0.06121120178929506

### balanced_accuracy
- Scores = [ 0.6287878787878788, 0.7803030303030303, 0.696969696969697, 0.8181818181818181, 0.8181818181818181, 0.7608695652173914, 0.7695652173913043, 0.8695652173913043 ]
- Mean = 0.7678030303030303
- Standard deviation = 0.07069440303215327

### f1
- Scores = [ 0.42105263157894735, 0.5882352941176471, 0.5, 0.6, 0.6, 0.47619047619047616, 0.5333333333333333, 0.625 ]
- Mean = 0.5429764669025505
- Standard deviation = 0.06758822473661402

### Confusion Matrix
|  | Predicted Negative | Predicted Positive |
| --- | --- | --- |
| Actual Negative | 119 | 60 |
| Actual Positive | 6 | 39 |

      