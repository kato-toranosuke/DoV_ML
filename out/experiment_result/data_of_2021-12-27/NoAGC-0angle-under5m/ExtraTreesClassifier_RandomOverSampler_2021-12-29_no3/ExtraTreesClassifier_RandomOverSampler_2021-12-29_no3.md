# ExtraTreesClassifier_RandomOverSampler_2021-12-29_no3
## Constants
- CSV_PATH = ../out/csv/experiment
- OUTPUT_PATH = ../out/experiment_result/data_of_2021-12-27/NoAGC-0angle-under5m
- FEATURE_ATTRBS = ['low_power', 'high_power', 'hlbr', 'coe1[0]', 'coe1[1]', 'coe3[0]', 'coe3[1]', 'coe3[2]', 'coe3[3]', 'ratio_max_to_10ms_ave_peaks', 'ratio_max_to_9th_ave_peaks', 'ac_std', 'ac_auc', 'diff_std', 'diff_auc', 'srmr', 'gp_max_val_std', 'gp_max_val_range', 'gp_max_val_min', 'gp_max_val_max', 'gp_max_val_mean', 'gp_max_ix_std', 'gp_max_ix_range', 'gp_max_ix_min', 'gp_max_ix_max', 'gp_max_ix_mean', 'gp_auc_std', 'gp_auc_range', 'gp_auc_min', 'gp_auc_max', 'gp_auc_mean', 'tdoa_std', 'tdoa_range', 'tdoa_min', 'tdoa_max', 'tdoa_mean']
- LABEL_ATTRB = ['facing']
- FACING_DOV_ANGLES = [1]
- NCV = 8
- SCORING = ['accuracy', 'balanced_accuracy', 'f1']
- REFIT_SCORING = balanced_accuracy
- PARAM_GRID = [{'est__n_estimators': [50, 100, 150, 200, 300], 'est__min_samples_split': [2, 5, 10], 'est__min_samples_leaf': [1, 5, 10], 'est__max_features': ['sqrt', 'log2', None], 'est__bootstrap': [False], 'est__n_jobs': [-1], 'est__random_state': [42], 'est__max_samples': [0.01, 0.5, 0.09]}, {'est__n_estimators': [50, 100, 150, 200, 300], 'est__min_samples_split': [2, 5, 10], 'est__min_samples_leaf': [1, 5, 10], 'est__max_features': ['sqrt', 'log2', None], 'est__bootstrap': [True], 'est__oob_score': [True, False], 'est__n_jobs': [-1], 'est__random_state': [42], 'est__max_samples': [0.01, 0.5, 0.09]}]
- TRAIN_SET_SESSION = ['trial1', 'trial2']
- TEST_SET_SESSION = ['trial3', 'trial4', 'trial5']
- DISTANCE = [1, 3, 5]
- AGC_STATUS = ['NoAGC']

## Loaded CSV
- 2021-12-27_raspi_48000Hz_w1_N2^12_overlap80_new.csv

## Estimator
### Type
- resampler = RandomOverSampler
- estimator = ExtraTreesClassifier

### Arguments for hyperparameter search
- resampler = RandomOverSampler
- estimator = ExtraTreesClassifier
- param_grid = 
	- {'est__n_estimators': [50, 100, 150, 200, 300], 'est__min_samples_split': [2, 5, 10], 'est__min_samples_leaf': [1, 5, 10], 'est__max_features': ['sqrt', 'log2', None], 'est__bootstrap': [False], 'est__n_jobs': [-1], 'est__random_state': [42], 'est__max_samples': [0.01, 0.5, 0.09]}
	- {'est__n_estimators': [50, 100, 150, 200, 300], 'est__min_samples_split': [2, 5, 10], 'est__min_samples_leaf': [1, 5, 10], 'est__max_features': ['sqrt', 'log2', None], 'est__bootstrap': [True], 'est__oob_score': [True, False], 'est__n_jobs': [-1], 'est__random_state': [42], 'est__max_samples': [0.01, 0.5, 0.09]}

- scoring = ['accuracy', 'balanced_accuracy', 'f1']
- refit = balanced_accuracy
- cv = 8

### Parameters of the best estimator
#### The best hyper-parameters
- best_resampler
	- sampling_strategy = auto
	- random_state = 42
	- shrinkage = None
	- n_features_in_ = 36
	- sampling_strategy_ = OrderedDict([(1, 72)])
	- shrinkage_ = None
	- sample_indices_ = [  0   1   2   3   4   5   6   7   8   9  10  11  12  13  14  15  16  17
  18  19  20  21  22  23  24  25  26  27  28  29  30  31  32  33  34  35
  36  37  38  39  40  41  42  43  44  45  46  47  48  49  50  51  52  53
  54  55  56  57  58  59  60  61  62  63  64  65  66  67  68  69  70  71
  72  73  74  75  76  77  78  79  80  81  82  83  84  85  86  87  88  89
  90  91  92  93  94  95  96  97  98  99 100 101 102 103 104 105 106 107
 108 109 110 111 112 113 114 115 116 117 118 119  32  97  74  52  33 106
  32  96 116  52  52 117 106  11  33 117  10 107 106   1 117  53  21   1
 106   0  53 107  53  84  43  75  74  74  96  53 116  97  10  20  96  32
 106  42  32  85  11  65  85  42 106   1  97  74  32  53  33  74  10  65
  84  11  85  33  11   1  21 107  43  11 107  85]

- best_estimator
	- base_estimator = ExtraTreeClassifier()
	- n_estimators = 100
	- estimator_params = ('criterion', 'max_depth', 'min_samples_split', 'min_samples_leaf', 'min_weight_fraction_leaf', 'max_features', 'max_leaf_nodes', 'min_impurity_decrease', 'min_impurity_split', 'random_state', 'ccp_alpha')
	- bootstrap = True
	- oob_score = True
	- n_jobs = -1
	- random_state = 42
	- verbose = 0
	- warm_start = False
	- class_weight = None
	- max_samples = 0.5
	- criterion = gini
	- max_depth = None
	- min_samples_split = 2
	- min_samples_leaf = 5
	- min_weight_fraction_leaf = 0.0
	- max_features = None
	- max_leaf_nodes = None
	- min_impurity_decrease = 0.0
	- min_impurity_split = None
	- ccp_alpha = 0.0
	- n_features_in_ = 36
	- n_features_ = 36
	- n_outputs_ = 1
	- classes_ = [0 1]
	- n_classes_ = 2
	- base_estimator_ = ExtraTreeClassifier()
	- oob_decision_function_ = [[0.29055423 0.70944577]
 [0.15236064 0.84763936]
 [0.24544074 0.75455926]
 [0.09300113 0.90699887]
 [0.57393472 0.42606528]
 [0.51507357 0.48492643]
 [0.95927189 0.04072811]
 [0.96585249 0.03414751]
 [0.95443948 0.04556052]
 [0.99731183 0.00268817]
 [0.18828704 0.81171296]
 [0.06642355 0.93357645]
 [0.70783761 0.29216239]
 [0.56058901 0.43941099]
 [0.82926362 0.17073638]
 [0.79807157 0.20192843]
 [0.98314574 0.01685426]
 [0.99116162 0.00883838]
 [1.         0.        ]
 [1.         0.        ]
 [0.73816416 0.26183584]
 [0.38652917 0.61347083]
 [0.72004741 0.27995259]
 [0.59726329 0.40273671]
 [0.96675627 0.03324373]
 [0.97550629 0.02449371]
 [0.99025341 0.00974659]
 [1.         0.        ]
 [0.98574423 0.01425577]
 [0.97809077 0.02190923]
 [0.28876368 0.71123632]
 [0.11754115 0.88245885]
 [0.15949297 0.84050703]
 [0.14675525 0.85324475]
 [0.4644118  0.5355882 ]
 [0.34452543 0.65547457]
 [0.87361864 0.12638136]
 [0.8057404  0.1942596 ]
 [0.97392998 0.02607002]
 [0.94919962 0.05080038]
 [0.67755675 0.32244325]
 [0.49127628 0.50872372]
 [0.60514456 0.39485544]
 [0.13883385 0.86116615]
 [0.67670118 0.32329882]
 [0.60116919 0.39883081]
 [0.72815072 0.27184928]
 [0.63872928 0.36127072]
 [0.99453552 0.00546448]
 [1.         0.        ]
 [0.91551856 0.08448144]
 [0.81409556 0.18590444]
 [0.26414264 0.73585736]
 [0.16944078 0.83055922]
 [0.83559289 0.16440711]
 [0.30621725 0.69378275]
 [0.98579235 0.01420765]
 [0.99425287 0.00574713]
 [1.         0.        ]
 [1.         0.        ]
 [0.76505639 0.23494361]
 [0.70209094 0.29790906]
 [0.53542033 0.46457967]
 [0.25462606 0.74537394]
 [0.38260363 0.61739637]
 [0.28921259 0.71078741]
 [0.74420872 0.25579128]
 [0.67436624 0.32563376]
 [0.67704486 0.32295514]
 [0.67883832 0.32116168]
 [0.82902857 0.17097143]
 [0.70466731 0.29533269]
 [0.61908319 0.38091681]
 [0.58599125 0.41400875]
 [0.39316281 0.60683719]
 [0.30516961 0.69483039]
 [0.52922135 0.47077865]
 [0.31085219 0.68914781]
 [0.67422469 0.32577531]
 [0.70093172 0.29906828]
 [0.965617   0.034383  ]
 [0.95456349 0.04543651]
 [0.82270807 0.17729193]
 [0.65704486 0.34295514]
 [0.53380661 0.46619339]
 [0.17054472 0.82945528]
 [0.81109583 0.18890417]
 [0.66367312 0.33632688]
 [0.9871345  0.0128655 ]
 [0.97798742 0.02201258]
 [0.95586124 0.04413876]
 [0.97060931 0.02939069]
 [0.8170813  0.1829187 ]
 [0.7582365  0.2417635 ]
 [0.49861318 0.50138682]
 [0.58343164 0.41656836]
 [0.23764451 0.76235549]
 [0.25701317 0.74298683]
 [0.63513898 0.36486102]
 [0.79703435 0.20296565]
 [0.98703704 0.01296296]
 [0.99666667 0.00333333]
 [0.96191716 0.03808284]
 [0.90449383 0.09550617]
 [0.48833401 0.51166599]
 [0.31511058 0.68488942]
 [0.05275762 0.94724238]
 [0.08914082 0.91085918]
 [0.43787752 0.56212248]
 [0.47884611 0.52115389]
 [0.98648776 0.01351224]
 [0.96408046 0.03591954]
 [0.9657364  0.0342636 ]
 [0.93528807 0.06471193]
 [0.84332545 0.15667455]
 [0.46532607 0.53467393]
 [0.26810112 0.73189888]
 [0.1184712  0.8815288 ]
 [0.42459868 0.57540132]
 [0.67804962 0.32195038]
 [0.13554575 0.86445425]
 [0.25589283 0.74410717]
 [0.36666522 0.63333478]
 [0.27759234 0.72240766]
 [0.13742833 0.86257167]
 [0.03699786 0.96300214]
 [0.15885555 0.84114445]
 [0.18611207 0.81388793]
 [0.28607081 0.71392919]
 [0.26979235 0.73020765]
 [0.2624888  0.7375112 ]
 [0.12208533 0.87791467]
 [0.04812217 0.95187783]
 [0.05167319 0.94832681]
 [0.14358809 0.85641191]
 [0.0882752  0.9117248 ]
 [0.18594199 0.81405801]
 [0.08479532 0.91520468]
 [0.04431446 0.95568554]
 [0.13838119 0.86161881]
 [0.12371893 0.87628107]
 [0.16525771 0.83474229]
 [0.31177002 0.68822998]
 [0.16006367 0.83993633]
 [0.0438847  0.9561153 ]
 [0.30710606 0.69289394]
 [0.18725797 0.81274203]
 [0.06713152 0.93286848]
 [0.18266762 0.81733238]
 [0.5134442  0.4865558 ]
 [0.18732032 0.81267968]
 [0.26283106 0.73716894]
 [0.33510133 0.66489867]
 [0.33720202 0.66279798]
 [0.20406256 0.79593744]
 [0.18956124 0.81043876]
 [0.2627423  0.7372577 ]
 [0.29537392 0.70462608]
 [0.15535857 0.84464143]
 [0.72604102 0.27395898]
 [0.21180946 0.78819054]
 [0.16774965 0.83225035]
 [0.03820844 0.96179156]
 [0.63457739 0.36542261]
 [0.11344395 0.88655605]
 [0.21349366 0.78650634]
 [0.06364603 0.93635397]
 [0.26549992 0.73450008]
 [0.18962227 0.81037773]
 [0.68464586 0.31535414]
 [0.03767699 0.96232301]
 [0.13687593 0.86312407]
 [0.25297619 0.74702381]
 [0.36650596 0.63349404]
 [0.13894994 0.86105006]
 [0.19766272 0.80233728]
 [0.12574571 0.87425429]
 [0.36442741 0.63557259]
 [0.162405   0.837595  ]
 [0.31047093 0.68952907]
 [0.5172989  0.4827011 ]
 [0.07731986 0.92268014]
 [0.18282662 0.81717338]
 [0.13847955 0.86152045]
 [0.06112013 0.93887987]
 [0.15927638 0.84072362]
 [0.34062573 0.65937427]
 [0.08970849 0.91029151]
 [0.20182717 0.79817283]
 [0.06892168 0.93107832]
 [0.06371173 0.93628827]
 [0.14526056 0.85473944]]
	- oob_score_ = 0.8697916666666666

#### Importance of features
- gp_auc_min = 0.11824534510884678
- gp_max_val_min = 0.10408295860001034
- srmr = 0.08996787992754363
- gp_max_val_max = 0.07527969904271956
- gp_max_val_mean = 0.057143036253909256
- gp_auc_max = 0.05406421299043696
- high_power = 0.05318933824671072
- diff_auc = 0.04594244844445902
- gp_auc_mean = 0.04374433821256174
- hlbr = 0.04330124771684999
- diff_std = 0.03911892363256856
- coe1[1] = 0.021898453702278917
- gp_max_val_range = 0.020490931942772888
- gp_auc_range = 0.018842308701451916
- coe1[0] = 0.018772608421145483
- low_power = 0.018300828206703198
- tdoa_range = 0.01806185082392769
- ratio_max_to_10ms_ave_peaks = 0.016488195363535088
- gp_max_ix_max = 0.013310343517759799
- tdoa_max = 0.012961947258853536
- gp_max_ix_min = 0.01252625978715615
- ratio_max_to_9th_ave_peaks = 0.010635432514479994
- coe3[3] = 0.010479486563094326
- tdoa_min = 0.01011861428241925
- ac_std = 0.009402867838768269
- gp_max_ix_std = 0.00879068355967237
- gp_max_ix_mean = 0.008167666687245785
- ac_auc = 0.008013013739581451
- coe3[2] = 0.007706742214659892
- gp_auc_std = 0.007531134090529021
- tdoa_std = 0.007120469687539259
- tdoa_mean = 0.0065191893711590435
- gp_max_val_std = 0.006242031417153931
- gp_max_ix_range = 0.003539512131496319
- coe3[0] = 0.0
- coe3[1] = 0.0

## Evaluation
cv = 8
### accuracy
- Scores = [ 0.7391304347826086, 0.7391304347826086, 0.8260869565217391, 0.9090909090909091, 0.45454545454545453, 0.8636363636363636, 0.8636363636363636, 0.8181818181818182 ]
- Mean = 0.7766798418972332
- Standard deviation = 0.13388872270292904

### balanced_accuracy
- Scores = [ 0.6888888888888889, 0.5444444444444444, 0.8888888888888888, 0.8, 0.5694444444444444, 0.8194444444444444, 0.9166666666666667, 0.8888888888888888 ]
- Mean = 0.7645833333333334
- Standard deviation = 0.13718925323691977

### f1
- Scores = [ 0.5, 0.25, 0.7142857142857143, 0.7499999999999999, 0.3333333333333333, 0.6666666666666665, 0.7272727272727273, 0.6666666666666666 ]
- Mean = 0.5760281385281385
- Standard deviation = 0.18016047376499686

### Confusion Matrix
|  | Predicted Negative | Predicted Positive |
| --- | --- | --- |
| Actual Negative | 113 | 30 |
| Actual Positive | 10 | 26 |

      