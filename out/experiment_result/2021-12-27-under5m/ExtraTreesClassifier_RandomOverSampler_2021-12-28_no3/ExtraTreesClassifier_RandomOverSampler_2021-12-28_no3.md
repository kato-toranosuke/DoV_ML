# ExtraTreesClassifier_RandomOverSampler_2021-12-28_no3
## Constants
- CSV_PATH = ../out/csv/experiment
- OUTPUT_PATH = ../out/experiment_result
- FEATURE_ATTRBS = ['low_power', 'high_power', 'hlbr', 'coe1[0]', 'coe1[1]', 'coe3[0]', 'coe3[1]', 'coe3[2]', 'coe3[3]', 'ratio_max_to_10ms_ave_peaks', 'ratio_max_to_9th_ave_peaks', 'ac_std', 'ac_auc', 'diff_std', 'diff_auc', 'srmr', 'gp_max_val_std', 'gp_max_val_range', 'gp_max_val_min', 'gp_max_val_max', 'gp_max_val_mean', 'gp_max_ix_std', 'gp_max_ix_range', 'gp_max_ix_min', 'gp_max_ix_max', 'gp_max_ix_mean', 'gp_auc_std', 'gp_auc_range', 'gp_auc_min', 'gp_auc_max', 'gp_auc_mean', 'tdoa_std', 'tdoa_range', 'tdoa_min', 'tdoa_max', 'tdoa_mean']
- LABEL_ATTRB = ['facing']
- FACING_DOV_ANGLES = [1]
- NCV = 8
- SCORING = ['accuracy', 'balanced_accuracy', 'f1']
- REFIT_SCORING = balanced_accuracy
- PARAM_GRID = [{'est__n_estimators': [50, 100, 150, 200, 300], 'est__min_samples_split': [2, 5, 10], 'est__min_samples_leaf': [1, 5, 10], 'est__max_features': ['sqrt', 'log2', None], 'est__bootstrap': [False], 'est__n_jobs': [-1], 'est__random_state': [42], 'est__max_samples': [0.01, 0.5, 0.09]}, {'est__n_estimators': [50, 100, 150, 200, 300], 'est__min_samples_split': [2, 5, 10], 'est__min_samples_leaf': [1, 5, 10], 'est__max_features': ['sqrt', 'log2', None], 'est__bootstrap': [True], 'est__oob_score': [True, False], 'est__n_jobs': [-1], 'est__random_state': [42], 'est__max_samples': [0.01, 0.5, 0.09]}]
- TRAIN_SET_SESSION = ['trial1', 'trial2']
- TEST_SET_SESSION = ['trial3', 'trial4', 'trial5']

## Loaded CSV
- 2021-12-27_raspi_48000Hz_w1_N2^12_overlap80_withfacing.csv

## Estimator
### Type
- resampler = RandomOverSampler
- estimator = ExtraTreesClassifier

### Arguments for hyperparameter search
- resampler = RandomOverSampler
- estimator = ExtraTreesClassifier
- param_grid = 
	- {'est__n_estimators': [50, 100, 150, 200, 300], 'est__min_samples_split': [2, 5, 10], 'est__min_samples_leaf': [1, 5, 10], 'est__max_features': ['sqrt', 'log2', None], 'est__bootstrap': [False], 'est__n_jobs': [-1], 'est__random_state': [42], 'est__max_samples': [0.01, 0.5, 0.09]}
	- {'est__n_estimators': [50, 100, 150, 200, 300], 'est__min_samples_split': [2, 5, 10], 'est__min_samples_leaf': [1, 5, 10], 'est__max_features': ['sqrt', 'log2', None], 'est__bootstrap': [True], 'est__oob_score': [True, False], 'est__n_jobs': [-1], 'est__random_state': [42], 'est__max_samples': [0.01, 0.5, 0.09]}

- scoring = ['accuracy', 'balanced_accuracy', 'f1']
- refit = balanced_accuracy
- cv = 8

### Parameters of the best estimator
#### The best hyper-parameters
- best_resampler
	- sampling_strategy = auto
	- random_state = 42
	- shrinkage = None
	- n_features_in_ = 36
	- sampling_strategy_ = OrderedDict([(1, 88)])
	- shrinkage_ = None
	- sample_indices_ = [  0   1   2   3   4   5   6   7   8   9  10  11  12  13  14  15  16  17
  18  19  20  21  22  23  24  25  26  27  28  29  30  31  32  33  34  35
  36  37  38  39  40  41  42  43  44  45  46  47  48  49  50  51  52  53
  54  55  56  57  58  59  60  61  62  63  64  65  66  67  68  69  70  71
  72  73  74  75  76  77  78  79  80  81  82  83  84  85  86  87  88  89
  90  91  92  93  94  95  96  97  98  99 100 101 102 103 104 105 106 107
 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125
 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143
 144 145 146 147  32  97 146  74  52  33 146 106  32 129  96 116  52  52
 117 106  11  33 117  10 107 106   1 117  53 147  21   1 137 106   0  53
 129 107 146  53 128  84 136 136  43 137 137  75  74 147 147  74 147  96
  53 116  97 128  10  20  96  32 106  42  32  85  11 128 137  65  85 129
  42 129 106   1  97 137  74 137  32  53 146  33  74  10  65  84  11  85
  33  11]

- best_estimator
	- base_estimator = ExtraTreeClassifier()
	- n_estimators = 150
	- estimator_params = ('criterion', 'max_depth', 'min_samples_split', 'min_samples_leaf', 'min_weight_fraction_leaf', 'max_features', 'max_leaf_nodes', 'min_impurity_decrease', 'min_impurity_split', 'random_state', 'ccp_alpha')
	- bootstrap = True
	- oob_score = True
	- n_jobs = -1
	- random_state = 42
	- verbose = 0
	- warm_start = False
	- class_weight = None
	- max_samples = 0.09
	- criterion = gini
	- max_depth = None
	- min_samples_split = 10
	- min_samples_leaf = 1
	- min_weight_fraction_leaf = 0.0
	- max_features = log2
	- max_leaf_nodes = None
	- min_impurity_decrease = 0.0
	- min_impurity_split = None
	- ccp_alpha = 0.0
	- n_features_in_ = 36
	- n_features_ = 36
	- n_outputs_ = 1
	- classes_ = [0 1]
	- n_classes_ = 2
	- base_estimator_ = ExtraTreeClassifier()
	- oob_decision_function_ = [[0.44621126 0.55378874]
 [0.42409008 0.57590992]
 [0.4386544  0.5613456 ]
 [0.45556504 0.54443496]
 [0.37898642 0.62101358]
 [0.41884275 0.58115725]
 [0.83661699 0.16338301]
 [0.8334304  0.1665696 ]
 [0.86950196 0.13049804]
 [0.86243386 0.13756614]
 [0.38803906 0.61196094]
 [0.3924174  0.6075826 ]
 [0.48155677 0.51844323]
 [0.39407858 0.60592142]
 [0.66227262 0.33772738]
 [0.52165992 0.47834008]
 [0.90984012 0.09015988]
 [0.90831608 0.09168392]
 [0.82922271 0.17077729]
 [0.83038997 0.16961003]
 [0.50120801 0.49879199]
 [0.38510698 0.61489302]
 [0.78247642 0.21752358]
 [0.61231353 0.38768647]
 [0.8209429  0.1790571 ]
 [0.71516389 0.28483611]
 [0.88997523 0.11002477]
 [0.89958275 0.10041725]
 [0.88701978 0.11298022]
 [0.88627332 0.11372668]
 [0.43426381 0.56573619]
 [0.43379269 0.56620731]
 [0.41413588 0.58586412]
 [0.45115626 0.54884374]
 [0.42425418 0.57574582]
 [0.44491028 0.55508972]
 [0.57094688 0.42905312]
 [0.67807256 0.32192744]
 [0.89155983 0.10844017]
 [0.87371104 0.12628896]
 [0.63424953 0.36575047]
 [0.61883736 0.38116264]
 [0.37285698 0.62714302]
 [0.24048357 0.75951643]
 [0.41984533 0.58015467]
 [0.264981   0.735019  ]
 [0.6827144  0.3172856 ]
 [0.67448021 0.32551979]
 [0.92432014 0.07567986]
 [0.91856555 0.08143445]
 [0.49756732 0.50243268]
 [0.48954317 0.51045683]
 [0.61158322 0.38841678]
 [0.37855519 0.62144481]
 [0.46575558 0.53424442]
 [0.37078701 0.62921299]
 [0.76996323 0.23003677]
 [0.71005444 0.28994556]
 [0.85663755 0.14336245]
 [0.83767027 0.16232973]
 [0.68297902 0.31702098]
 [0.70273632 0.29726368]
 [0.45934631 0.54065369]
 [0.46846777 0.53153223]
 [0.45159941 0.54840059]
 [0.42039354 0.57960646]
 [0.34616172 0.65383828]
 [0.37109282 0.62890718]
 [0.63560051 0.36439949]
 [0.55570328 0.44429672]
 [0.84446208 0.15553792]
 [0.81719388 0.18280612]
 [0.6003351  0.3996649 ]
 [0.47427616 0.52572384]
 [0.2422096  0.7577904 ]
 [0.26641109 0.73358891]
 [0.36749352 0.63250648]
 [0.38209458 0.61790542]
 [0.69801036 0.30198964]
 [0.66108485 0.33891515]
 [0.87706349 0.12293651]
 [0.84100915 0.15899085]
 [0.81496116 0.18503884]
 [0.67714337 0.32285663]
 [0.36011097 0.63988903]
 [0.26317839 0.73682161]
 [0.5127466  0.4872534 ]
 [0.41409937 0.58590063]
 [0.77789623 0.22210377]
 [0.83462721 0.16537279]
 [0.84534014 0.15465986]
 [0.87134921 0.12865079]
 [0.57064063 0.42935937]
 [0.673541   0.326459  ]
 [0.43211156 0.56788844]
 [0.37814463 0.62185537]
 [0.26793161 0.73206839]
 [0.3086919  0.6913081 ]
 [0.425739   0.574261  ]
 [0.35231201 0.64768799]
 [0.81834734 0.18165266]
 [0.89350907 0.10649093]
 [0.79878939 0.20121061]
 [0.71709775 0.28290225]
 [0.33126219 0.66873781]
 [0.25375474 0.74624526]
 [0.26546626 0.73453374]
 [0.25070268 0.74929732]
 [0.42060472 0.57939528]
 [0.29270194 0.70729806]
 [0.90417695 0.09582305]
 [0.88678571 0.11321429]
 [0.88322155 0.11677845]
 [0.86469955 0.13530045]
 [0.61807814 0.38192186]
 [0.54186439 0.45813561]
 [0.29298158 0.70701842]
 [0.29146151 0.70853849]
 [0.43496168 0.56503832]
 [0.60740602 0.39259398]
 [0.85880333 0.14119667]
 [0.83800737 0.16199263]
 [0.85825857 0.14174143]
 [0.80328924 0.19671076]
 [0.64157817 0.35842183]
 [0.6405295  0.3594705 ]
 [0.34731718 0.65268282]
 [0.3714856  0.6285144 ]
 [0.36571635 0.63428365]
 [0.2995537  0.7004463 ]
 [0.85971465 0.14028535]
 [0.89510675 0.10489325]
 [0.76219519 0.23780481]
 [0.65030947 0.34969053]
 [0.32356427 0.67643573]
 [0.33227575 0.66772425]
 [0.31123468 0.68876532]
 [0.22915823 0.77084177]
 [0.89490079 0.10509921]
 [0.89693836 0.10306164]
 [0.91589002 0.08410998]
 [0.91355174 0.08644826]
 [0.86926173 0.13073827]
 [0.85207483 0.14792517]
 [0.5305416  0.4694584 ]
 [0.56984179 0.43015821]
 [0.31270796 0.68729204]
 [0.40760472 0.59239528]
 [0.42369651 0.57630349]
 [0.28976629 0.71023371]
 [0.309274   0.690726  ]
 [0.24081035 0.75918965]
 [0.61544386 0.38455614]
 [0.45718311 0.54281689]
 [0.29854579 0.70145421]
 [0.26699428 0.73300572]
 [0.42340462 0.57659538]
 [0.29031318 0.70968682]
 [0.25894583 0.74105417]
 [0.28893785 0.71106215]
 [0.59677489 0.40322511]
 [0.60586601 0.39413399]
 [0.27506831 0.72493169]
 [0.26308833 0.73691167]
 [0.38724998 0.61275002]
 [0.46262107 0.53737893]
 [0.28658751 0.71341249]
 [0.39150963 0.60849037]
 [0.25239045 0.74760955]
 [0.26383796 0.73616204]
 [0.43410152 0.56589848]
 [0.28308003 0.71691997]
 [0.38961195 0.61038805]
 [0.40316071 0.59683929]
 [0.39675049 0.60324951]
 [0.43025441 0.56974559]
 [0.23264533 0.76735467]
 [0.26970281 0.73029719]
 [0.41882447 0.58117553]
 [0.37591014 0.62408986]
 [0.29010806 0.70989194]
 [0.25134359 0.74865641]
 [0.30499935 0.69500065]
 [0.39476675 0.60523325]
 [0.37736132 0.62263868]
 [0.37260234 0.62739766]
 [0.31542274 0.68457726]
 [0.31594811 0.68405189]
 [0.23383525 0.76616475]
 [0.23475763 0.76524237]
 [0.2221392  0.7778608 ]
 [0.2632847  0.7367153 ]
 [0.25175179 0.74824821]
 [0.40566548 0.59433452]
 [0.42056909 0.57943091]
 [0.2473078  0.7526922 ]
 [0.41151149 0.58848851]
 [0.27550638 0.72449362]
 [0.40875868 0.59124132]
 [0.29920061 0.70079939]
 [0.29357891 0.70642109]
 [0.35427655 0.64572345]
 [0.39610597 0.60389403]
 [0.50503653 0.49496347]
 [0.27765205 0.72234795]
 [0.42356814 0.57643186]
 [0.26521954 0.73478046]
 [0.37477762 0.62522238]
 [0.42079777 0.57920223]
 [0.25684015 0.74315985]
 [0.39062201 0.60937799]
 [0.36047604 0.63952396]
 [0.23903291 0.76096709]
 [0.39836628 0.60163372]
 [0.28360854 0.71639146]
 [0.29251495 0.70748505]
 [0.36292105 0.63707895]
 [0.29681517 0.70318483]
 [0.26325326 0.73674674]
 [0.43467158 0.56532842]
 [0.29023355 0.70976645]
 [0.2269093  0.7730907 ]
 [0.24421891 0.75578109]
 [0.22881342 0.77118658]
 [0.43167388 0.56832612]
 [0.4020671  0.5979329 ]
 [0.29990657 0.70009343]
 [0.45485758 0.54514242]
 [0.23939527 0.76060473]
 [0.40027262 0.59972738]
 [0.40220315 0.59779685]
 [0.36240955 0.63759045]
 [0.39463915 0.60536085]
 [0.27451299 0.72548701]
 [0.44400104 0.55599896]
 [0.40870404 0.59129596]]
	- oob_score_ = 0.8177966101694916

#### Importance of features
- gp_auc_min = 0.08239887279613273
- gp_auc_max = 0.07244889595153121
- coe1[0] = 0.06519444378629059
- diff_auc = 0.06273766613880265
- gp_max_val_mean = 0.060698285169148145
- gp_max_val_min = 0.06047422678137738
- high_power = 0.06024577007335559
- gp_auc_mean = 0.04839923500528057
- gp_max_val_max = 0.045179229310492196
- coe1[1] = 0.03966920754263635
- srmr = 0.038989909920437105
- ac_auc = 0.037735526624470404
- diff_std = 0.03337874956459221
- low_power = 0.03302311480796137
- ac_std = 0.02555959450023171
- ratio_max_to_10ms_ave_peaks = 0.02547834999155791
- gp_max_val_std = 0.019672163415390378
- hlbr = 0.01855980683897126
- coe3[3] = 0.016559869397477986
- gp_max_val_range = 0.015755177598565807
- ratio_max_to_9th_ave_peaks = 0.013427915095824012
- gp_max_ix_min = 0.012557070691091693
- gp_auc_std = 0.0118104956305176
- gp_max_ix_mean = 0.011706550147625599
- coe3[2] = 0.011651889877420451
- tdoa_min = 0.010515993941949834
- tdoa_std = 0.009860523043777051
- tdoa_max = 0.009860081529255485
- tdoa_mean = 0.009406504842028578
- gp_max_ix_std = 0.009383322698415504
- tdoa_range = 0.009125731354056163
- gp_max_ix_max = 0.007411022146855513
- gp_max_ix_range = 0.0056040338677483745
- gp_auc_range = 0.005520769918730731
- coe3[0] = 0.0
- coe3[1] = 0.0

## Evaluation
cv = 8
### accuracy
- Scores = [ 0.6428571428571429, 0.75, 0.75, 0.7142857142857143, 0.7142857142857143, 0.6071428571428571, 0.75, 0.7857142857142857 ]
- Mean = 0.7142857142857142
- Standard deviation = 0.056469243931578206

### balanced_accuracy
- Scores = [ 0.6515151515151515, 0.7803030303030303, 0.7803030303030303, 0.8181818181818181, 0.8181818181818181, 0.7608695652173914, 0.7695652173913043, 0.8695652173913043 ]
- Mean = 0.781060606060606
- Standard deviation = 0.05906778916204039

### f1
- Scores = [ 0.4444444444444444, 0.5882352941176471, 0.5882352941176471, 0.6, 0.6, 0.47619047619047616, 0.5333333333333333, 0.625 ]
- Mean = 0.5569298552754435
- Standard deviation = 0.06127019174405451

### Confusion Matrix
|  | Predicted Negative | Predicted Positive |
| --- | --- | --- |
| Actual Negative | 120 | 59 |
| Actual Positive | 5 | 40 |

      